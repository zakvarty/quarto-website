<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Zak Varty</title>
<link>https://www.zakvarty.com/blog.html</link>
<atom:link href="https://www.zakvarty.com/blog.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.0.38</generator>
<lastBuildDate>Tue, 13 Dec 2022 00:00:00 GMT</lastBuildDate>
<item>
  <title>Git: putting your new feature out into the world.</title>
  <dc:creator>Zak Varty</dc:creator>
  <link>https://www.zakvarty.com/blog/2022-12-13-git-remote-branches/index.html</link>
  <description><![CDATA[ 



<div class="small_left">
<p><img style="border-radius: 10%;" src="https://www.zakvarty.com/blog/2022-12-13-git-remote-branches/git-logo.png" alt="git logo. This is a red-orange square with rounded corners, it is rotated by 45 degrees so that it is standing on one corner and has a cut-out design representing a branching graph."></p>
</div>
<p>So you’ve added a new feature to your project. You were responsible and didn’t do this in the <code>main</code> branch. Congrats on being responsible, have some brownie points.</p>
<p>Now how the heck to you get everything moved across and delete your <code>new-feature</code> branch?</p>
<section id="check-that-your-local-main-is-up-to-date." class="level2">
<h2 class="anchored" data-anchor-id="check-that-your-local-main-is-up-to-date.">1. Check that your local <code>main</code> is up to date.</h2>
<p>Be in the <code>main</code> branch and pull any changes to the remote <code>main</code> branch.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;">git</span> checkout main </span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">git</span> pull origin main</span></code></pre></div>
<p>This might require you to resolve some merge conflicts, but these should be pretty straightforward if you are following a branch-and-merge workflow.</p>
</section>
<section id="check-that-you-remote-new-feature-is-up-to-date." class="level2">
<h2 class="anchored" data-anchor-id="check-that-you-remote-new-feature-is-up-to-date.">2. Check that you remote <code>new-feature</code> is up to date.</h2>
<p>We might mess things up while merging. Let’s make sure that if that happens we can get back to this good position with our new feature.</p>
<pre><code>git checkout new-feature
git status</code></pre>
<p>If needed: <code>add</code>, <code>commit</code> and <code>push</code>.</p>
</section>
<section id="merge-any-changes-to-main-into-your-local-new-feature-branch" class="level2">
<h2 class="anchored" data-anchor-id="merge-any-changes-to-main-into-your-local-new-feature-branch">3. Merge any changes to <code>main</code> into your local <code>new-feature</code> branch</h2>
<p>Next, we will make sure we have any changes to <code>main</code> moved across to our local <code>new-feature</code> branch.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;">git</span> merge main</span></code></pre></div>
<p>This might again require resolving some merge conflicts. Keep calm and take tea breaks are required.</p>
</section>
<section id="commit-and-push-to-remote." class="level2">
<h2 class="anchored" data-anchor-id="commit-and-push-to-remote.">4. Commit and push to remote.</h2>
<p>Now that we have our local <code>new-feature</code> branch compatible with the remote <code>main</code> branch, lets push that to the remote.</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;">git</span> add <span class="op" style="color: #5E5E5E;">&lt;</span>YOUR_FILES_TO_COMMIT<span class="op" style="color: #5E5E5E;">&gt;</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;">git</span> commit <span class="at" style="color: #657422;">-m</span> <span class="st" style="color: #20794D;">"merge changes to main in preparation for PR"</span></span>
<span id="cb4-3"><span class="fu" style="color: #4758AB;">git</span> push</span></code></pre></div>
</section>
<section id="open-a-pull-request-on-github" class="level2">
<h2 class="anchored" data-anchor-id="open-a-pull-request-on-github">5. Open a pull request on Github</h2>
<p>Wait for someone to review approve your new feature (or wait a few hours/days and do it yourself for a solo project).</p>
</section>
<section id="delete-the-local-branch" class="level2">
<h2 class="anchored" data-anchor-id="delete-the-local-branch">6. Delete the local branch</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;">git</span> checkout main</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;">git</span> branch <span class="at" style="color: #657422;">--delete</span> new-feature</span></code></pre></div>
</section>
<section id="delete-the-remote-branch" class="level2">
<h2 class="anchored" data-anchor-id="delete-the-remote-branch">7. Delete the remote branch</h2>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="fu" style="color: #4758AB;">git</span> push origin <span class="at" style="color: #657422;">--delete</span> new-feature</span></code></pre></div>
<p>On older versions of git (&lt; 1.7.0) you might need to use the alternative syntax below. This is effectively pushing nothing to the new-feature branch of origin.</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="fu" style="color: #4758AB;">git</span> push origin :new-feature</span></code></pre></div>
<p>Bam! You did it! Your <code>new-feature</code> is out there in the wild, making the world a marginally better place.</p>


</section>

 ]]></description>
  <category>workflows</category>
  <category>git</category>
  <guid>https://www.zakvarty.com/blog/2022-12-13-git-remote-branches/index.html</guid>
  <pubDate>Tue, 13 Dec 2022 00:00:00 GMT</pubDate>
  <media:content url="https://www.zakvarty.com/blog/2022-12-13-git-remote-branches/git-logo.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Web Scraping with {rvest}</title>
  <dc:creator>Zak Varty</dc:creator>
  <link>https://www.zakvarty.com/blog/2022-12-01-rvest/index.html</link>
  <description><![CDATA[ 



<section id="aquiring-data-part-1---scraping-webpage-data-using-rvest" class="level2">
<h2 class="anchored" data-anchor-id="aquiring-data-part-1---scraping-webpage-data-using-rvest">Aquiring Data: Part 1 - Scraping webpage data using {rvest}</h2>
<div class="medium_right">
<p><img style="border-radius: 10%;" src="https://www.zakvarty.com/blog/2022-12-01-rvest/rvest-logo.png" alt="Hexagonal logo of the rvest package; a sickle cutting wheat on a red background."></p>
</div>
<p>You can’t always rely on tidy, tabular data to land on your desk. Sometimes you are going to have to go out and gather data for yourself.</p>
<p>I’m not suggesting you will need to do this manually, but you will likely need to get data from the internet that’s been made publicly or privately available to you.</p>
<p>This might be information from a webpage that you gather yourself, or data shared with you by a collaborator using an API.</p>
<p>In this first blog post we will cover the basics of scraping webpages, following the <a href="https://cran.r-project.org/web/packages/rvest/vignettes/rvest.html#fnref3">vignette</a> for the {rvest} package.</p>
</section>
<section id="what-is-a-webpage" class="level2">
<h2 class="anchored" data-anchor-id="what-is-a-webpage">What is a webpage?</h2>
<p>Before we can even hope to get data from a webpage, we first need to understand <em>what</em> a webpage is.</p>
<p>Webpages are written in a similar way to LaTeX: the content and styling of webpages are handled separately and are coded using plain text files.</p>
<p>In fact, websites go one step further than LaTeX. The content and styling of websites are written in different files and in different languages. HTML (HyperText Markup Language) is used to write the content and then CSS (Cascading Style Sheets) are used to control the appearance of that content when it’s displayed to the user.</p>
</section>
<section id="html" class="level2">
<h2 class="anchored" data-anchor-id="html">HTML</h2>
<p>A basic HTML page with no styling applied might look something like this:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb1-1"><span class="kw" style="color: #003B4F;">&lt;html&gt;</span></span>
<span id="cb1-2"><span class="kw" style="color: #003B4F;">&lt;head&gt;</span></span>
<span id="cb1-3">  <span class="kw" style="color: #003B4F;">&lt;title&gt;</span>Page title<span class="kw" style="color: #003B4F;">&lt;/title&gt;</span></span>
<span id="cb1-4"><span class="kw" style="color: #003B4F;">&lt;/head&gt;</span></span>
<span id="cb1-5"><span class="kw" style="color: #003B4F;">&lt;body&gt;</span></span>
<span id="cb1-6">  <span class="kw" style="color: #003B4F;">&lt;h1</span> <span class="er" style="color: #AD0000;">id</span><span class="ot" style="color: #003B4F;">=</span><span class="st" style="color: #20794D;">'first'</span><span class="kw" style="color: #003B4F;">&gt;</span>A level 1 heading<span class="kw" style="color: #003B4F;">&lt;/h1&gt;</span></span>
<span id="cb1-7">  <span class="kw" style="color: #003B4F;">&lt;p&gt;</span>Hello World!<span class="kw" style="color: #003B4F;">&lt;/p&gt;</span></span>
<span id="cb1-8">  <span class="kw" style="color: #003B4F;">&lt;p&gt;</span>Here is some plain text <span class="dv" style="color: #AD0000;">&amp;amp;</span> <span class="kw" style="color: #003B4F;">&lt;b&gt;</span>some bold text.<span class="kw" style="color: #003B4F;">&lt;/b&gt;&lt;/p&gt;</span></span>
<span id="cb1-9">  <span class="kw" style="color: #003B4F;">&lt;img</span> <span class="er" style="color: #AD0000;">src</span><span class="ot" style="color: #003B4F;">=</span><span class="st" style="color: #20794D;">'myimg.png'</span> <span class="er" style="color: #AD0000;">width</span><span class="ot" style="color: #003B4F;">=</span><span class="st" style="color: #20794D;">'100'</span> <span class="er" style="color: #AD0000;">height</span><span class="ot" style="color: #003B4F;">=</span><span class="st" style="color: #20794D;">'100'</span><span class="kw" style="color: #003B4F;">&gt;</span></span>
<span id="cb1-10"><span class="kw" style="color: #003B4F;">&lt;/body&gt;</span></span></code></pre></div>
<section id="html-elements" class="level3">
<h3 class="anchored" data-anchor-id="html-elements">HTML elements</h3>
<!-- for presentation 
```{.html}
#| code-line-numbers: "3"
<html>
<head>
  <title>Page title</title>
</head>
<body>
  <h1 id='first'>A level 1 heading</h1>
  <p>Hello World!</p>
  <p>Here is some plain text &amp; <b>some bold text.</b></p>
  <img src='myimg.png' width='100' height='100'>
</body>
```
-->
<p>Just like XML data files, HTML has a hierarchical structure. This structure is crafted using HTML elements. Each HTML element is made up of of a start tag, optional attributes, an end tag.</p>
<p>We can see each of these in the first level header, where <code>&lt;h1&gt;</code> is the opening tag, <code>id='first'</code> is an additional attribute and <code>&lt;/h1&gt;</code> is the closing tag. Everything between the opening and closing tag are the contents of that element. There are also some special elements that consist of only a single tag and its optional attributes. An example of this is the <code>&lt;img&gt;</code> tag.</p>
<p>Since <code>&lt;</code> and <code>&gt;</code> are used for start and end tags, you can’t write them directly in an HTML document. Instead, you have to use escape characters. This sounds fancy, but it’s just an alternative way to write characters that serve some special function within a language.</p>
<p>You can write greater than <code>&amp;gt;</code> and less than as <code>&amp;lt;</code>. You might notice that those escapes use an ampersand (&amp;). This means that if you want a literal ampersand on your webpage, you have to escape too using <code>&amp;amp;</code>.</p>
<p>There are a wide range of possible HTML tags and escapes. We’ll cover the most common tags in this lecture and you don’t need to worry about escapes too much because <code>{rvest}</code> will automatically handle them for you.</p>
</section>
<section id="important-html-elements" class="level3">
<h3 class="anchored" data-anchor-id="important-html-elements">Important HTML Elements</h3>
<p>In all, there are in excess of 100 HTML elements. The most important ones for you to know about are:</p>
<ul>
<li><p>The <code>&lt;html&gt;</code> element, that must enclose every HTML page. The <code>&lt;html&gt;</code> element must have two child elements within it. The <code>&lt;head&gt;</code> element contains metadata about the document, like the page title that is shown in the browser tab and the CSS style sheet that should be applied. The <code>&lt;body&gt;</code> element then contains all of the content that you see in the browser.</p></li>
<li><p>Block elements are used to give structure to the page. These are elements like headings, sub-headings and so on from <code>&lt;h1&gt;</code> all the way down to <code>&lt;h6&gt;</code>. This category also contains paragraph elements <code>&lt;p&gt;</code>, ordered lists <code>&lt;ol&gt;</code> unordered lists <code>&lt;ul&gt;</code>.</p></li>
<li><p>Finally, inline tags like <code>&lt;b&gt;</code> for bold, <code>&lt;i&gt;</code> for italics, and <code>&lt;a&gt;</code> for hyperlinks are used to format text inside block elements.</p></li>
</ul>
<p>When you come across a tag that you’ve never seen before, you can find out what it does with just a little bit of googling. A good resource here is the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML">MDN Web Docs</a> which are produced by Mozilla, the company that makes the Firefox web browser. The <a href="https://www.w3schools.com/html/default.asp">W3schools website</a> is another great resource for web development and coding resources more generally.</p>
</section>
</section>
<section id="html-attributes" class="level2">
<h2 class="anchored" data-anchor-id="html-attributes">HTML Attributes</h2>
<p>We’ve seen one example of a header with an additional attribute. More generally, all tags can have named attributes. These attributes are contained within the opening tag and look something like:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb2-1"><span class="kw" style="color: #003B4F;">&lt;tag</span> <span class="er" style="color: #AD0000;">attribute1</span><span class="ot" style="color: #003B4F;">=</span><span class="st" style="color: #20794D;">'value1'</span> <span class="er" style="color: #AD0000;">attribute2</span><span class="ot" style="color: #003B4F;">=</span><span class="st" style="color: #20794D;">'value2'</span><span class="kw" style="color: #003B4F;">&gt;</span>element contents<span class="kw" style="color: #003B4F;">&lt;/tag&gt;</span></span></code></pre></div>
<p>Two of the most important attributes are <code>id</code> and <code>class</code>. These attributes are used in conjunction with the CSS file to control the visual appearance of the page. These are often very useful to identify the elements that you are interested in when scraping data off a page.</p>
</section>
<section id="css-selectors" class="level2">
<h2 class="anchored" data-anchor-id="css-selectors">CSS Selectors</h2>
<p>The Cascading Style Sheet is used to describe how your HTML content will be displayed. To do this, CSS has it’s own system for selecting elements of a webpage, called CSS selectors.</p>
<p>CSS selectors define patterns for locating the HTML elements that a particular style should be applied to. A happy side-effect of this is that they can sometimes be very useful for scraping, because they provide a concise way of describing which elements you want to extract.</p>
<p>CSS Selectors can work on the level of an element type, a class, or a tag and these can be used in a nested (or <em>cascading</em>) way.</p>
<ul>
<li><p>The <code>p</code> selector will select all paragraph <code>&lt;p&gt;</code> elements.</p></li>
<li><p>The <code>.title</code> selector will select all elements with class <code>“title”</code>.</p></li>
<li><p>The <code>p.special</code> selector will select all<code>&lt;p&gt;</code> elements with class <code>“special”</code>.</p></li>
<li><p>The <code>#title</code> selector will select the element with the id attribute <code>“title”</code>.</p></li>
</ul>
<p>When you want to select a single element <code>id</code> attributes are particularly useful because that <em>must</em> be unique within a html document. Unfortunately, this is only helpful if the developer added an <code>id</code> attribute to the element(s) you want to scrape!</p>
<p>If you want to learn more CSS selectors I recommend starting with the fun <a href="https://flukeout.github.io/">CSS dinner tutorial</a> to build a base of knowledge and then using the <a href="https://www.w3schools.com/css/default.asp">W3schools resources</a> as a reference to explore more webpages in the wild.</p>
</section>
<section id="which-attributes-and-selectors-do-you-need" class="level2">
<h2 class="anchored" data-anchor-id="which-attributes-and-selectors-do-you-need">Which Attributes and Selectors Do You Need?</h2>
<p>To scrape data from a webpage, you first have to identify the tag and attribute combinations that you are interested in gathering.</p>
<p>To find your elements of interest, you have three options. These go from hardest to easiest but also from most to least robust.</p>
<ul>
<li>right click + “inspect page source” (F12)</li>
<li>right click + “inspect”</li>
<li>Rvest <a href="https://rvest.tidyverse.org/articles/selectorgadget.html">Selector Gadget</a> (very useful but fallible)</li>
</ul>
<p>Inspecting the source of some familiar websites can be a useful way to get your head around these concepts. Beware though that sophisticated webpages can be quite intimidating. A good place to start is with simpler, static websites such as personal websites, rather than the dynamic webpages of online retailers or social media platforms.</p>
</section>
<section id="reading-html-with-rvest" class="level2">
<h2 class="anchored" data-anchor-id="reading-html-with-rvest">Reading HTML with <code>{rvest}</code></h2>
<p>With <code>{rvest}</code>, reading a html page can be as simple as loading in tabular data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">html <span class="ot" style="color: #003B4F;">&lt;-</span> rvest<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">read_html</span>(<span class="st" style="color: #20794D;">"https://www.zakvarty.com/professional/teaching.html"</span>)</span></code></pre></div>
</div>
<p>The <code>class</code> of the resulting object is an <code>xml_document</code>. This type of object is from the low-level package <code>{xml2}</code>, which allows you to read xml files into R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;">class</span>(html)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "xml_document" "xml_node"    </code></pre>
</div>
</div>
<p>We can see that this object is split into several components: first is some metadata on the type of document we have scraped, followed by the head and then the body of that html document.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">html</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{html_document}
&lt;html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"&gt;
[1] &lt;head&gt;\n&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8 ...
[2] &lt;body class="nav-fixed"&gt;\n\n&lt;div id="quarto-search-results"&gt;&lt;/div&gt;\n  &lt;he ...</code></pre>
</div>
</div>
<p>We have several possible approaches to extracting information from this document.</p>
</section>
<section id="extracting-html-elements" class="level2">
<h2 class="anchored" data-anchor-id="extracting-html-elements">Extracting HTML elements</h2>
<p>In <code>{rvest}</code> you can extract a single element with <code>html_element()</code>, or all matching elements with <code>html_elements()</code>. Both functions take a document object and one or more CSS selectors as inputs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;">library</span>(rvest)</span>
<span id="cb8-2">html <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_elements</span>(<span class="st" style="color: #20794D;">"h1"</span>)</span>
<span id="cb8-3"><span class="do" style="color: #5E5E5E;
font-style: italic;">## {xml_nodeset (1)}</span></span>
<span id="cb8-4"><span class="do" style="color: #5E5E5E;
font-style: italic;">## [1] &lt;h1&gt;Teaching&lt;/h1&gt;</span></span>
<span id="cb8-5">html <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_elements</span>(<span class="st" style="color: #20794D;">"h2"</span>)</span>
<span id="cb8-6"><span class="do" style="color: #5E5E5E;
font-style: italic;">## {xml_nodeset (2)}</span></span>
<span id="cb8-7"><span class="do" style="color: #5E5E5E;
font-style: italic;">## [1] &lt;h2 id="toc-title"&gt;On this page&lt;/h2&gt;</span></span>
<span id="cb8-8"><span class="do" style="color: #5E5E5E;
font-style: italic;">## [2] &lt;h2 class="anchored" data-anchor-id="course-history"&gt;Course History&lt;/h2&gt;</span></span>
<span id="cb8-9">html <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_elements</span>(<span class="st" style="color: #20794D;">"p"</span>)</span>
<span id="cb8-10"><span class="do" style="color: #5E5E5E;
font-style: italic;">## {xml_nodeset (2)}</span></span>
<span id="cb8-11"><span class="do" style="color: #5E5E5E;
font-style: italic;">## [1] &lt;p&gt;I am fortunate to have had the opportunity to teach in a variety of ro ...</span></span>
<span id="cb8-12"><span class="do" style="color: #5E5E5E;
font-style: italic;">## [2] &lt;p&gt;I am an associate fellow of the Higher Education Academy, which you ca ...</span></span></code></pre></div>
</div>
<p>You can also combine and nest these selectors. For example you might want to extract all links that are within paragraphs <em>and</em> all second level headers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">html <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_elements</span>(<span class="st" style="color: #20794D;">"p a,h2"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{xml_nodeset (3)}
[1] &lt;h2 id="toc-title"&gt;On this page&lt;/h2&gt;
[2] &lt;a href="https://www.advance-he.ac.uk/fellowship/associate-fellowship"&gt;he ...
[3] &lt;h2 class="anchored" data-anchor-id="course-history"&gt;Course History&lt;/h2&gt;</code></pre>
</div>
</div>
</section>
<section id="extracting-data-from-html-elements" class="level2">
<h2 class="anchored" data-anchor-id="extracting-data-from-html-elements">Extracting Data From HTML Elements</h2>
<p>Now that we’ve got the elements we care about extracted from the complete document. But how do we get the data we need out of those elements?</p>
<p>You’ll usually get the data from either the contents of the HTML element or else from one of it’s attributes. If you’re really lucky, the data you need will already be formatted for you as a HTML table or list.</p>
<section id="extracting-text" class="level3">
<h3 class="anchored" data-anchor-id="extracting-text">Extracting text</h3>
<p>The functions <code>rvest::html_text()</code> and <code>rvest::html_text2()</code> can be used to extract the plain text contents of an HTML element.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">html <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;">html_elements</span>(<span class="st" style="color: #20794D;">"#teaching li"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;">html_text2</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "one-to-one tuition for high school students;"                                   
[2] "running workshops and computer labs for undergraduate and postgraduate modules;"
[3] "delivering short courses on scientific communication and LaTeX;"                
[4] "supervising an undergraduate research project;"                                 
[5] "developing and lecturing postgraduate modules in statistics and data science."  </code></pre>
</div>
</div>
<p>The difference between <code>html_text()</code> and <code>html_text2()</code> is in how they handle whitespace. In HTML whitespace and line breaks have very little influence over how the code is interpreted by the computer (this is similar to R but very different from Python). <code>html_text()</code> will extract the text as it is in the raw html, while <code>html_text2()</code> will do its best to extract the text in a way that gives you something similar to what you’d see in the browser.</p>
</section>
<section id="extracting-attributes" class="level3">
<h3 class="anchored" data-anchor-id="extracting-attributes">Extracting Attributes</h3>
<p>Attributes are also used to record information that you might like to collect. For example, the destination of links are stored in the <code>href</code> attribute and the source of images is stored in the <code>src</code> attribute.</p>
<p>As an example of this, consider trying to extract the twitter link from the icon in the page footer. This is quite tricky to locate in the html source, so I used the <a href="https://rvest.tidyverse.org/articles/selectorgadget.html">Selector Gadget</a> to help find the correct combination of elements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">html <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_element</span>(<span class="st" style="color: #20794D;">".compact:nth-child(1) .nav-link"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{html_node}
&lt;a class="nav-link" href="https://www.twitter.com/zakvarty"&gt;
[1] &lt;i class="bi bi-twitter" role="img"&gt;\n&lt;/i&gt;</code></pre>
</div>
</div>
<p>To extract the <code>href</code> attribute from the scraped element, we use the <code>rvest::html_attr()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">html <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;">html_elements</span>(<span class="st" style="color: #20794D;">".compact:nth-child(1) .nav-link"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;">html_attr</span>(<span class="st" style="color: #20794D;">"href"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "https://www.twitter.com/zakvarty"</code></pre>
</div>
</div>
<p><strong>Note:</strong> <code>rvest::html_attr()</code> will always return a character string (or list of character strings). If you are extracting an attribute that describes a quantity, such as the width of an image, you’ll need to convert this from a string to your required data type. For example, of the width is measures in pixels you might use <code>as.integer()</code>.</p>
</section>
<section id="extracting-tables" class="level3">
<h3 class="anchored" data-anchor-id="extracting-tables">Extracting tables</h3>
<p>HTML tables are composed in a similar, nested manner to LaTeX tables.</p>
<p>There are four main elements to know about that make up an HTML table:</p>
<ul>
<li><code>&lt;table&gt;</code>,</li>
<li><code>&lt;tr&gt;</code> (table row),</li>
<li><code>&lt;th&gt;</code> (table heading),</li>
<li><code>&lt;td&gt;</code> (table data).</li>
</ul>
<p>Here’s our simple example data, formatted as an HTML table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">html_2 <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">minimal_html</span>(<span class="st" style="color: #20794D;">"</span></span>
<span id="cb17-2"><span class="st" style="color: #20794D;">  &lt;table&gt;</span></span>
<span id="cb17-3"><span class="st" style="color: #20794D;">    &lt;tr&gt;</span></span>
<span id="cb17-4"><span class="st" style="color: #20794D;">      &lt;th&gt;Name&lt;/th&gt;</span></span>
<span id="cb17-5"><span class="st" style="color: #20794D;">      &lt;th&gt;Number&lt;/th&gt;</span></span>
<span id="cb17-6"><span class="st" style="color: #20794D;">    &lt;/tr&gt;</span></span>
<span id="cb17-7"><span class="st" style="color: #20794D;">    &lt;tr&gt;</span></span>
<span id="cb17-8"><span class="st" style="color: #20794D;">      &lt;td&gt;A&lt;/td&gt;</span></span>
<span id="cb17-9"><span class="st" style="color: #20794D;">      &lt;td&gt;1&lt;/td&gt;</span></span>
<span id="cb17-10"><span class="st" style="color: #20794D;">    &lt;/tr&gt;</span></span>
<span id="cb17-11"><span class="st" style="color: #20794D;">    &lt;tr&gt;</span></span>
<span id="cb17-12"><span class="st" style="color: #20794D;">      &lt;td&gt;B&lt;/td&gt;</span></span>
<span id="cb17-13"><span class="st" style="color: #20794D;">      &lt;td&gt;2&lt;/td&gt;</span></span>
<span id="cb17-14"><span class="st" style="color: #20794D;">    &lt;/tr&gt;</span></span>
<span id="cb17-15"><span class="st" style="color: #20794D;">    &lt;tr&gt;</span></span>
<span id="cb17-16"><span class="st" style="color: #20794D;">      &lt;td&gt;C&lt;/td&gt;</span></span>
<span id="cb17-17"><span class="st" style="color: #20794D;">      &lt;td&gt;3&lt;/td&gt;</span></span>
<span id="cb17-18"><span class="st" style="color: #20794D;">    &lt;/tr&gt;</span></span>
<span id="cb17-19"><span class="st" style="color: #20794D;">  &lt;/table&gt;</span></span>
<span id="cb17-20"><span class="st" style="color: #20794D;">  "</span>)</span></code></pre></div>
</div>
<p>Since tables are a common way to store data, <code>{rvest}</code> includes a useful function <code>html_table()</code> that converts directly from an HTML table into a tibble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">html_2 <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-2">  <span class="fu" style="color: #4758AB;">html_element</span>(<span class="st" style="color: #20794D;">"table"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb18-3">  <span class="fu" style="color: #4758AB;">html_table</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  Name  Number
  &lt;chr&gt;  &lt;int&gt;
1 A          1
2 B          2
3 C          3</code></pre>
</div>
</div>
<p>Applying this to our real scraped data we can easily extract the table of taught courses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">html <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb20-2">  <span class="fu" style="color: #4758AB;">html_element</span>(<span class="st" style="color: #20794D;">"table"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb20-3">  <span class="fu" style="color: #4758AB;">html_table</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 3
   Year      Course                                   Role                      
   &lt;chr&gt;     &lt;chr&gt;                                    &lt;chr&gt;                     
 1 "2021-22" Supervised Learning                      Lecturer                  
 2 ""        Ethics in Data Science I                 Lecturer                  
 3 ""        Ethics in Data Science II                Lecturer                  
 4 "—"       —                                        —                         
 5 "2020-21" MATH562/582: Extreme Value Theory        Lecturer                  
 6 ""        MATH331: Bayesian Inference              Graduate teaching assista…
 7 ""        MATH330: Likelihood Inference            Graduate teaching assista…
 8 "2019-20" DSCI485: Introduction to LaTeX           Co-leading short course   
 9 ""        MATH566: Longitudinal Data Analysis      Graduate teaching assista…
10 "2018-19" STOR-i Internship: Introduction to LaTeX Co-leading short course   
# … with 15 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="tip-for-building-tibbles" class="level2">
<h2 class="anchored" data-anchor-id="tip-for-building-tibbles">Tip for Building Tibbles</h2>
<p>When scraping data from a webpage, your end-goal is typically going to be constructing a data.frame or a tibble.</p>
<p>If you are following our description of tidy data, you’ll want each row to correspond some repeated unit on the HTML page. In this case, you should</p>
<ol type="1">
<li>Use <code>html_elements()</code> to select the elements that contain each observation unit;</li>
<li>Use <code>html_element()</code> to extract the variables from each of those observations.</li>
</ol>
<p>Taking this approach guarantees that you’ll get the same number of values for each variable, because <code>html_element()</code> always returns the same number of outputs as inputs. This is vital when you have missing data - when not every observation unit has a value for every variable of interest.</p>
<p>As an example, consider this extract of text about the <a href="https://dplyr.tidyverse.org/reference/starwars.html#ref-examples">starwars dataset</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">starwars_html <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">minimal_html</span>(<span class="st" style="color: #20794D;">"</span></span>
<span id="cb22-2"><span class="st" style="color: #20794D;">  &lt;ul&gt;</span></span>
<span id="cb22-3"><span class="st" style="color: #20794D;">    &lt;li&gt;&lt;b&gt;C-3PO&lt;/b&gt; is a &lt;i&gt;droid&lt;/i&gt; that weighs &lt;span class='weight'&gt;167 kg&lt;/span&gt;&lt;/li&gt;</span></span>
<span id="cb22-4"><span class="st" style="color: #20794D;">    &lt;li&gt;&lt;b&gt;R2-D2&lt;/b&gt; is a &lt;i&gt;droid&lt;/i&gt; that weighs &lt;span class='weight'&gt;96 kg&lt;/span&gt;&lt;/li&gt;</span></span>
<span id="cb22-5"><span class="st" style="color: #20794D;">    &lt;li&gt;&lt;b&gt;Yoda&lt;/b&gt; weighs &lt;span class='weight'&gt;66 kg&lt;/span&gt;&lt;/li&gt;</span></span>
<span id="cb22-6"><span class="st" style="color: #20794D;">    &lt;li&gt;&lt;b&gt;R4-P17&lt;/b&gt; is a &lt;i&gt;droid&lt;/i&gt;&lt;/li&gt;</span></span>
<span id="cb22-7"><span class="st" style="color: #20794D;">  &lt;/ul&gt;</span></span>
<span id="cb22-8"><span class="st" style="color: #20794D;">  "</span>)</span></code></pre></div>
</div>
<p>This is an unordered list where each list item corresponds to one observational unit (one character from the starwars universe). The name of the character is given in bold, the character species is specified in italics and the weight of the character is denoted by the <code>.weight</code> class. However, some characters have only a subset of these variables defined: for example Yoda has no species entry.</p>
<p>If we try to extract each element directly, our vectors of variable values are of different lengths. We don’t know where the missing values should be, so we can’t line them back up to make a tibble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">starwars_html <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_elements</span>(<span class="st" style="color: #20794D;">"b"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_text2</span>()</span>
<span id="cb23-2"><span class="do" style="color: #5E5E5E;
font-style: italic;">## [1] "C-3PO"  "R2-D2"  "Yoda"   "R4-P17"</span></span>
<span id="cb23-3">starwars_html <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_elements</span>(<span class="st" style="color: #20794D;">"i"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_text2</span>()</span>
<span id="cb23-4"><span class="do" style="color: #5E5E5E;
font-style: italic;">## [1] "droid" "droid" "droid"</span></span>
<span id="cb23-5">starwars_html <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_elements</span>(<span class="st" style="color: #20794D;">".weight"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_text2</span>()</span>
<span id="cb23-6"><span class="do" style="color: #5E5E5E;
font-style: italic;">## [1] "167 kg" "96 kg"  "66 kg"</span></span></code></pre></div>
</div>
<p>What we should do instead is start by extracting all of the list item elements using <code>html_elements()</code>. Once we have done this, we can then use <code>html_element()</code> to extract each variable for all characters. This will pad with NAs, so that we can collate them into a tibble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">starwars_characters <span class="ot" style="color: #003B4F;">&lt;-</span> starwars_html <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_elements</span>(<span class="st" style="color: #20794D;">"li"</span>)</span>
<span id="cb24-2"></span>
<span id="cb24-3">starwars_characters <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_element</span>(<span class="st" style="color: #20794D;">"b"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_text2</span>()</span>
<span id="cb24-4"><span class="do" style="color: #5E5E5E;
font-style: italic;">## [1] "C-3PO"  "R2-D2"  "Yoda"   "R4-P17"</span></span>
<span id="cb24-5">starwars_characters <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_element</span>(<span class="st" style="color: #20794D;">"i"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_text2</span>()</span>
<span id="cb24-6"><span class="do" style="color: #5E5E5E;
font-style: italic;">## [1] "droid" "droid" NA      "droid"</span></span>
<span id="cb24-7">starwars_characters <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_element</span>(<span class="st" style="color: #20794D;">".weight"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_text2</span>()</span>
<span id="cb24-8"><span class="do" style="color: #5E5E5E;
font-style: italic;">## [1] "167 kg" "96 kg"  "66 kg"  NA</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">tibble<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">tibble</span>(</span>
<span id="cb25-2">  <span class="at" style="color: #657422;">name =</span> starwars_characters <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_element</span>(<span class="st" style="color: #20794D;">"b"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_text2</span>(),</span>
<span id="cb25-3">  <span class="at" style="color: #657422;">species =</span> starwars_characters <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_element</span>(<span class="st" style="color: #20794D;">"i"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_text2</span>(),</span>
<span id="cb25-4">  <span class="at" style="color: #657422;">weight =</span> starwars_characters <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_element</span>(<span class="st" style="color: #20794D;">".weight"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">html_text2</span>()</span>
<span id="cb25-5">)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  name   species weight
  &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; 
1 C-3PO  droid   167 kg
2 R2-D2  droid   96 kg 
3 Yoda   &lt;NA&gt;    66 kg 
4 R4-P17 droid   &lt;NA&gt;  </code></pre>
</div>
</div>


</section>

<div id="quarto-appendix"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{varty2022,
  author = {Zak Varty},
  title = {Web {Scraping} with `\{Rvest\}`},
  date = {2022-12-01},
  url = {https://www.zakvarty.com/blog/2022-12-01-rvest},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-varty2022" class="csl-entry quarto-appendix-citeas">
Zak Varty. 2022. <span>“Web Scraping with `{Rvest}`.”</span> December 1,
2022. <a href="https://www.zakvarty.com/blog/2022-12-01-rvest">https://www.zakvarty.com/blog/2022-12-01-rvest</a>.
</div></div></section></div> ]]></description>
  <category>data science</category>
  <category>data acquisition</category>
  <category>tutorial</category>
  <guid>https://www.zakvarty.com/blog/2022-12-01-rvest/index.html</guid>
  <pubDate>Thu, 01 Dec 2022 00:00:00 GMT</pubDate>
  <media:content url="https://www.zakvarty.com/blog/2022-12-01-rvest/rvest-logo.png" medium="image" type="image/png" height="167" width="144"/>
</item>
<item>
  <title>Good Enough Practices in Scientific Computing</title>
  <dc:creator>Zak Varty</dc:creator>
  <link>https://www.zakvarty.com/blog/2022-10-19-good-enough-practices-in-scientific-computing/index.html</link>
  <description><![CDATA[ 



<!--Photo by <a href="https://unsplash.com/@qwitka?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Maksym Kaharlytskyi</a> on <a href="https://unsplash.com/s/photos/filing-cabinet?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Unsplash</a> -->
<section id="reading-summary" class="level2">
<h2 class="anchored" data-anchor-id="reading-summary">Reading Summary</h2>
<p><code>wilson2017good</code></p>
<p><strong>Title:</strong> <em>Good Enough Practices in Scientific Computing. {PLOS Computational Biology, 2017} (20 pages).</em></p>
<p><strong>Authors:</strong> <em>Greg Wilson, Jennifer Bryan, Karen Cranston, Justin Kitzes, Lex Nederbragt and Tracy K. Teal.</em></p>
<p><strong>Key words:</strong> <em>computing</em>, <em>research skills</em>, <em>reproducibilty</em>, <em>guides</em>.</p>
<p>In this paper by <span class="citation" data-cites="wilson2017good">Wilson et al. (2017)</span>, a collection of experienced researchers and instructors give simple ways to implement good computing practices during a research project. They do this by providing a list of concrete recommendations that every researcher can adopt, regardless of their current computational skills. This is important to help the transition toward open, documented and reproducible research. The article is aimed specifically at people who are new to computational research but also contains useful guidance for more experienced researchers.</p>
</section>
<section id="notes" class="level2">
<h2 class="anchored" data-anchor-id="notes">Notes</h2>
<p>This article describes some of the best-practices in software development and how those ideas can be implemented in a reasearch project. This focus here is on implementing these approaches without requiring reseachers to learn how to use lots of peripheral technologies (for example git and LaTeX / markdown).</p>
<p>An earlier paper “Best Practices for Scientifc Computing” <span class="citation" data-cites="wilson2014best">(Wilson et al. 2014)</span>, is aimed at those who have or would like to develop such peripheral skills.</p>
</section>
<section id="suggested-best-practices" class="level2">
<h2 class="anchored" data-anchor-id="suggested-best-practices">Suggested Best Practices</h2>
<p>Best practices are grouped into 6 main themes.</p>
<section id="data-management" class="level3">
<h3 class="anchored" data-anchor-id="data-management">1. Data Management</h3>
<section id="create-the-data-you-wish-to-see-in-the-world" class="level4">
<h4 class="anchored" data-anchor-id="create-the-data-you-wish-to-see-in-the-world">Create the data you wish to see in the world</h4>
<p>Raw data should be created in a format that is ammenable to analysis and where multiple tables are used, a unique identifer used to link each record across these tables.</p>
</section>
<section id="keep-it-backed-up-keep-it-intact" class="level4">
<h4 class="anchored" data-anchor-id="keep-it-backed-up-keep-it-intact">Keep it backed up, keep it intact</h4>
<p>This raw data should be backed up in more than one location and preserved during the analysis (i.e.&nbsp;<strong>not</strong> directly edited). When cleaning, handling and modelling the data keep a record of all steps used.</p>
</section>
<section id="share-the-data" class="level4">
<h4 class="anchored" data-anchor-id="share-the-data">Share the data</h4>
<p>To allow your future self (and others) to access and cite your hard won data, submit it to a reputable DOI-issuing repository.</p>
</section>
</section>
<section id="software" class="level3">
<h3 class="anchored" data-anchor-id="software">2. Software</h3>
<section id="script-files" class="level4">
<h4 class="anchored" data-anchor-id="script-files">Script files</h4>
<p>Start each script with a brief explanatory comment of its purpose and a description of any dependencies.</p>
<p>Within scripts, ruthlessly eliminate duplication. Do this by creating functions for any repeated operations and provide simple examples of how those functions work.</p>
<p>When making functions and variables, give them meaningful names. As rule of thumb: fuctions are verbs, variables are nouns.</p>
<p>If you need your script to perform different actions, control this behaviour programmatically rather than by commenting/uncommenting sections of code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;"># Uncomment for weekly reports</span></span>
<span id="cb1-2">output_dir <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">paste0</span>(<span class="st" style="color: #20794D;">"weekly_reports/"</span>,year,<span class="st" style="color: #20794D;">"/"</span>,week_of_year,<span class="st" style="color: #20794D;">"/"</span>)</span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;"># Uncomment for annual reports</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;">#output_dir &lt;- paste0("annual_reports/",year,"/")</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">report_type <span class="ot" style="color: #003B4F;">=</span> <span class="st" style="color: #20794D;">"weekly"</span></span>
<span id="cb2-2">year <span class="ot" style="color: #003B4F;">=</span> <span class="dv" style="color: #AD0000;">2022</span></span>
<span id="cb2-3">week_of_year <span class="ot" style="color: #003B4F;">=</span> <span class="dv" style="color: #AD0000;">21</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="cf" style="color: #003B4F;">if</span> (report_type <span class="sc" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"weekly"</span>) {</span>
<span id="cb2-6">  output_dir <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">paste0</span>(<span class="st" style="color: #20794D;">"weekly_reports/"</span>,year,<span class="st" style="color: #20794D;">"/"</span>,week_of_year,<span class="st" style="color: #20794D;">"/"</span>)</span>
<span id="cb2-7">} <span class="cf" style="color: #003B4F;">else</span> <span class="cf" style="color: #003B4F;">if</span> (report_type <span class="sc" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"annual"</span>) {</span>
<span id="cb2-8">  output_dir <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">paste0</span>(<span class="st" style="color: #20794D;">"annual_reports/"</span>,year,<span class="st" style="color: #20794D;">"/"</span>)</span>
<span id="cb2-9">} <span class="cf" style="color: #003B4F;">else</span> {</span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;">stop</span>(<span class="st" style="color: #20794D;">"report_type should be 'weekly' or 'annual'."</span>)</span>
<span id="cb2-11">}</span></code></pre></div>
</div>
<p>Submit the final code for your research project to to a reputable DOI-issuing repository.</p>
</section>
<section id="external-code" class="level4">
<h4 class="anchored" data-anchor-id="external-code">External Code</h4>
<p>Before writing your own code, check if someone else got there first. Are there well-maintained software libraries that already do what you need?</p>
<p>If so, test the code (extensively!) before relying on it. Keep a record of what you have tested and add to this as you find awkward edge cases.</p>
</section>
</section>
<section id="collaboration" class="level3">
<h3 class="anchored" data-anchor-id="collaboration">3. Collaboration</h3>
<section id="collaborating-within-your-team" class="level4">
<h4 class="anchored" data-anchor-id="collaborating-within-your-team">Collaborating within your team</h4>
<p>Create a single file called <code>README</code> giving an overview of your project. This should describe aim of the project and how to get started working with the data/code/writing. A good rule of thumb is to write this as though it were for either a new-starter on your team. Future you will thank you!</p>
<p>Create a shared to-do list for the project in a file called <code>TODO</code> and decide on how you will communicate during the project. For example, what channels will you use for group meetings, quick questions, assigning tasks and setting deadlines?</p>
</section>
<section id="opening-up-to-the-wider-world" class="level4">
<h4 class="anchored" data-anchor-id="opening-up-to-the-wider-world">Opening up to the wider world</h4>
<p>Add another file called <code>LICENSE</code> giving the licensing information for the project. This says who can use it and for what purposes. No license implies you are keeping all rights and nobody is allowed to reuse or modify the materials. For more information on licenses see <a href="choosealicense.com">choosealicense.com</a> or <a href="https://opensource.guide/legal/#which-open-source-license-is-appropriate-for-my-project">The Open Source Guide</a>. Consult your company’s legal folks as needed.</p>
<p>Create a final file called <code>CITATION</code> letting other people know how they should give proper attribution to your work if they use it.</p>
</section>
</section>
<section id="project-organisation" class="level3">
<h3 class="anchored" data-anchor-id="project-organisation">4. Project Organisation</h3>
<p>Each project should be self-contained in its own directory (folder) and this directory should be named after the project.</p>
<p>Create subdirectories called:</p>
<ul>
<li><code>docs/</code> for all text documents associated with the project</li>
<li><code>data/raw/</code> for all raw data and metadata</li>
<li><code>data/derived/</code> for all data files during cleanup and analysis</li>
<li><code>src</code> for all code you write as part of this project</li>
<li><code>bin</code> for all external code or compiled programs that you use in this project</li>
</ul>
<p>When adding files and subdirectories within this structure, name these to clearly reflect their content or function.</p>
</section>
<section id="tracking-changes" class="level3">
<h3 class="anchored" data-anchor-id="tracking-changes">5. Tracking Changes</h3>
<p>As soon as any file is created by a human, back it up in multiple locations. If you make a huge file, then consult your IT folks about how to store and back it up.</p>
<p>Add a file called <code>CHANGELOG</code> to the docs subfolder. Use this to track all changes made within the project by all contributers, describing when the changes happened and why they were made.</p>
<p>Keep these changes as small as possible and share among collaborators frequently to avoid getting out of sync.</p>
<p>Make a Copy the entire project whenever a significant change has been made.</p>
<p>Better yet, use a dedicated version control system such as git if that is a realistic option.</p>
</section>
<section id="manuscripts" class="level3">
<h3 class="anchored" data-anchor-id="manuscripts">6. Manuscripts</h3>
<p>Pick one and stick to it within each project. The former has a much lower bar to entry and has most of the benefits of the latter (other than manuscripts being stored in the same place as everything else).</p>
<ol type="1">
<li><p>Write the manuscript using online tools with rich formatting, change tracking and reference management. (e.g.&nbsp;Overleaf, Google Docs)</p></li>
<li><p>Write the manuscript in plain text format the permits version control (e.g.&nbsp;tex + git or markdown + git)</p></li>
</ol>



</section>
</section>

<div id="quarto-appendix"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-wilson2014best" class="csl-entry">
Wilson, Greg, D. A. Aruliah, C. Titus Brown, Neil P. Chue Hong, Matt Davis, Richard T. Guy, Steven H. D. Haddock, et al. 2014. <span>“Best Practices for Scientific Computing.”</span> <em>PLOS Biology</em> 12 (January): 1–7. <a href="https://doi.org/10.1371/journal.pbio.1001745">https://doi.org/10.1371/journal.pbio.1001745</a>.
</div>
<div id="ref-wilson2017good" class="csl-entry">
Wilson, Greg, Jennifer Bryan, Karen Cranston, Justin Kitzes, Lex Nederbragt, and Tracy K Teal. 2017. <span>“Good Enough Practices in Scientific Computing.”</span> <em>PLoS Computational Biology</em> 13 (June): 1–20. <a href="https://doi.org/10.1371/journal.pcbi.1005510">https://doi.org/10.1371/journal.pcbi.1005510</a>.
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section></div> ]]></description>
  <category>academic skills</category>
  <category>computing</category>
  <category>reproducible research</category>
  <category>reading summary</category>
  <guid>https://www.zakvarty.com/blog/2022-10-19-good-enough-practices-in-scientific-computing/index.html</guid>
  <pubDate>Tue, 18 Oct 2022 23:00:00 GMT</pubDate>
  <media:content url="https://www.zakvarty.com/blog/2022-10-19-good-enough-practices-in-scientific-computing/gepisc-image.png" medium="image" type="image/png" height="68" width="144"/>
</item>
<item>
  <title>Data Journalism: Recreating a Professional Plot</title>
  <dc:creator>Zak Varty</dc:creator>
  <link>https://www.zakvarty.com/blog/2022-10-15-BBC-temperature-plot/index.html</link>
  <description><![CDATA[ 



<section id="bbc-temperature-records" class="level1">
<h1>BBC Temperature Records</h1>
<p>On Friday 2022-10-14, the BBC Data Journalism Team released this excellent <a href="https://www.bbc.co.uk/news/science-environment-63244353">article</a> about the record temperatures in the UK during this summer’s heatwave. The article has some amazing data visualisations, and draws on a recent Met Office report.</p>
<p>I wanted to try and recreate one of the plots to test the limits of my ggplot knowledge. Since I had already tackled a stacked bar plot, I figured I might have a go at their dumbbell plot that shows the weather stations which exceeded their previous records largest margins.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.zakvarty.com/blog/2022-10-15-BBC-temperature-plot/bbc-temperature-records.png.webp" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">bbc temperature records dumbbell plot</figcaption><p></p>
</figure>
</div>
<p>I couldn’t find the data source, so spent <strong>far</strong> too long with a printed copy of the original figure to make my own version of the data set.</p>
<p>It took a while, but I got most of the way there with it and am happy with the final result.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.zakvarty.com/blog/2022-10-15-BBC-temperature-plot/zdv-temperature-records.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">my attempt at recreating the same plot</figcaption><p></p>
</figure>
</div>
<p>There were a few things that still have me stumped, that I might revisit at some later date:</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="">
Left aligning title and caption (Thanks to Jack Davison for this!)</li>
<li><input type="checkbox" disabled="">
Using gradients on multiple parts of the plot</li>
<li><input type="checkbox" disabled="">
Using the YeOrRd gradient, rather than default blues</li>
<li><input type="checkbox" disabled="">
Adding a non-BBC logo to the bottom right.</li>
</ul>
<p>If anyone with superior ggplot skills would like to help with those or give pointers, then I would be most grateful!</p>
<p>Code and figure down below ↓</p>
<div class="cell" data-fig.dpi="100">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;"># Load packages ----</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">library</span>(bbplot)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;">library</span>(tidyverse)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;">library</span>(showtext)</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;"># Import fonts ----</span></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;">font_add_google</span>(<span class="at" style="color: #657422;">name =</span> <span class="st" style="color: #20794D;">"Roboto Slab"</span>, <span class="at" style="color: #657422;">family =</span> <span class="st" style="color: #20794D;">"roboto-slab"</span>)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;">font_add_google</span>(<span class="at" style="color: #657422;">name =</span> <span class="st" style="color: #20794D;">"Roboto"</span>, <span class="at" style="color: #657422;">family =</span> <span class="st" style="color: #20794D;">"roboto"</span>)</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;">showtext_auto</span>()</span>
<span id="cb1-10">title_font <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="st" style="color: #20794D;">"roboto-slab"</span></span>
<span id="cb1-11">font <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="st" style="color: #20794D;">"roboto"</span></span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;"># Input data (estimated values from article) ---</span></span>
<span id="cb1-14">temperatures <span class="ot" style="color: #003B4F;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">tribble</span>(</span>
<span id="cb1-15">  <span class="sc" style="color: #5E5E5E;">~</span>location, <span class="sc" style="color: #5E5E5E;">~</span>max_prev, <span class="sc" style="color: #5E5E5E;">~</span>max_2022,</span>
<span id="cb1-16">  <span class="st" style="color: #20794D;">"Cranwell"</span>, <span class="fl" style="color: #AD0000;">36.6</span>, <span class="fl" style="color: #AD0000;">39.9</span>,</span>
<span id="cb1-17">  <span class="st" style="color: #20794D;">"Nottingham"</span>, <span class="fl" style="color: #AD0000;">36.0</span>, <span class="fl" style="color: #AD0000;">39.8</span>,</span>
<span id="cb1-18">  <span class="st" style="color: #20794D;">"Bramham"</span>, <span class="fl" style="color: #AD0000;">33.5</span>, <span class="fl" style="color: #AD0000;">39.8</span>,</span>
<span id="cb1-19">  <span class="st" style="color: #20794D;">"Sutton Boningon"</span>, <span class="fl" style="color: #AD0000;">35.9</span>, <span class="fl" style="color: #AD0000;">39.4</span>,</span>
<span id="cb1-20">  <span class="st" style="color: #20794D;">"Sheffield"</span>, <span class="fl" style="color: #AD0000;">35.6</span>, <span class="fl" style="color: #AD0000;">39.4</span>,</span>
<span id="cb1-21">  <span class="st" style="color: #20794D;">"Leeming"</span>, <span class="fl" style="color: #AD0000;">34.4</span>, <span class="fl" style="color: #AD0000;">38.7</span>,</span>
<span id="cb1-22">  <span class="st" style="color: #20794D;">"Goudhurst"</span>, <span class="fl" style="color: #AD0000;">34.7</span>, <span class="fl" style="color: #AD0000;">37.9</span>,</span>
<span id="cb1-23">  <span class="st" style="color: #20794D;">"Whitby"</span>, <span class="fl" style="color: #AD0000;">33.1</span>, <span class="fl" style="color: #AD0000;">37.8</span>,</span>
<span id="cb1-24">  <span class="st" style="color: #20794D;">"Bradford"</span>, <span class="fl" style="color: #AD0000;">33.9</span>, <span class="fl" style="color: #AD0000;">37.8</span>,</span>
<span id="cb1-25">  <span class="st" style="color: #20794D;">"High Mowthorpe"</span>, <span class="fl" style="color: #AD0000;">33.1</span>, <span class="fl" style="color: #AD0000;">37.2</span>,</span>
<span id="cb1-26">  <span class="st" style="color: #20794D;">"Blackpool"</span>, <span class="fl" style="color: #AD0000;">33.6</span>, <span class="fl" style="color: #AD0000;">37.2</span>,</span>
<span id="cb1-27">  <span class="st" style="color: #20794D;">"Durham"</span>, <span class="fl" style="color: #AD0000;">32.9</span>, <span class="fl" style="color: #AD0000;">36.9</span>,</span>
<span id="cb1-28">  <span class="st" style="color: #20794D;">"Preston"</span>, <span class="fl" style="color: #AD0000;">33.1</span>, <span class="fl" style="color: #AD0000;">36.5</span>,</span>
<span id="cb1-29">  <span class="st" style="color: #20794D;">"Morecambe"</span>, <span class="fl" style="color: #AD0000;">32.7</span>, <span class="fl" style="color: #AD0000;">36.4</span>,</span>
<span id="cb1-30">  <span class="st" style="color: #20794D;">"Stonyhurst"</span>, <span class="fl" style="color: #AD0000;">32.6</span>, <span class="fl" style="color: #AD0000;">36.3</span>,</span>
<span id="cb1-31">  <span class="st" style="color: #20794D;">"Keele"</span>, <span class="fl" style="color: #AD0000;">32.9</span>, <span class="fl" style="color: #AD0000;">36.2</span>,</span>
<span id="cb1-32">  <span class="st" style="color: #20794D;">"Bude"</span>, <span class="fl" style="color: #AD0000;">32.2</span>, <span class="fl" style="color: #AD0000;">36.1</span>,</span>
<span id="cb1-33">  <span class="st" style="color: #20794D;">"Buxton"</span>, <span class="fl" style="color: #AD0000;">32.7</span>, <span class="fl" style="color: #AD0000;">36.0</span>,</span>
<span id="cb1-34">  <span class="st" style="color: #20794D;">"Kielder Castle"</span>, <span class="fl" style="color: #AD0000;">29.6</span>, <span class="fl" style="color: #AD0000;">35.0</span>,</span>
<span id="cb1-35">  <span class="st" style="color: #20794D;">"Bala"</span>, <span class="fl" style="color: #AD0000;">31.9</span>, <span class="fl" style="color: #AD0000;">34.9</span></span>
<span id="cb1-36">)</span>
<span id="cb1-37"></span>
<span id="cb1-38"><span class="co" style="color: #5E5E5E;"># Data preparation ----</span></span>
<span id="cb1-39"></span>
<span id="cb1-40"><span class="do" style="color: #5E5E5E;
font-style: italic;">## For the points ----</span></span>
<span id="cb1-41">temperatures <span class="ot" style="color: #003B4F;">&lt;-</span> temperatures <span class="sc" style="color: #5E5E5E;">|&gt;</span></span>
<span id="cb1-42">  dplyr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">max_ever =</span> <span class="fu" style="color: #4758AB;">pmax</span>(max_2022, max_prev))</span>
<span id="cb1-43"></span>
<span id="cb1-44">temperatures<span class="sc" style="color: #5E5E5E;">$</span>location <span class="ot" style="color: #003B4F;">&lt;-</span> forcats<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">fct_reorder</span>(<span class="fu" style="color: #4758AB;">as.factor</span>(temperatures<span class="sc" style="color: #5E5E5E;">$</span>location), <span class="at" style="color: #657422;">.x =</span> temperatures<span class="sc" style="color: #5E5E5E;">$</span>max_ever)</span>
<span id="cb1-45"></span>
<span id="cb1-46">temp_long <span class="ot" style="color: #003B4F;">&lt;-</span> tidyr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">pivot_longer</span>(temperatures, <span class="at" style="color: #657422;">cols =</span> <span class="fu" style="color: #4758AB;">c</span>(max_2022, max_prev), <span class="at" style="color: #657422;">names_to =</span> <span class="st" style="color: #20794D;">"year"</span>,<span class="at" style="color: #657422;">values_to =</span> <span class="st" style="color: #20794D;">"temperature"</span>)</span>
<span id="cb1-47"></span>
<span id="cb1-48"><span class="do" style="color: #5E5E5E;
font-style: italic;">## For the bars ----</span></span>
<span id="cb1-49">n_interp <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="dv" style="color: #AD0000;">501</span></span>
<span id="cb1-50">temp_interpolated <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">tibble</span>(<span class="fu" style="color: #4758AB;">rep</span>(<span class="cn" style="color: #8f5902;">NA</span>, n_interp<span class="sc" style="color: #5E5E5E;">*</span><span class="dv" style="color: #AD0000;">20</span>))</span>
<span id="cb1-51">temp_interpolated[[<span class="dv" style="color: #AD0000;">1</span>]] <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">rep</span>(temperatures<span class="sc" style="color: #5E5E5E;">$</span>location, <span class="at" style="color: #657422;">each =</span> n_interp)</span>
<span id="cb1-52">temp_interpolated[[<span class="dv" style="color: #AD0000;">2</span>]] <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">rep</span>(<span class="cn" style="color: #8f5902;">NA_real_</span>, n_interp<span class="sc" style="color: #5E5E5E;">*</span><span class="dv" style="color: #AD0000;">20</span>)</span>
<span id="cb1-53"><span class="fu" style="color: #4758AB;">names</span>(temp_interpolated) <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"location"</span>, <span class="st" style="color: #20794D;">"interp_value"</span>)</span>
<span id="cb1-54"><span class="cf" style="color: #003B4F;">for</span> (i <span class="cf" style="color: #003B4F;">in</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">20</span>) {</span>
<span id="cb1-55">  temp_interpolated<span class="sc" style="color: #5E5E5E;">$</span>interp_value[(<span class="dv" style="color: #AD0000;">1</span> <span class="sc" style="color: #5E5E5E;">+</span> n_interp <span class="sc" style="color: #5E5E5E;">*</span> (i <span class="sc" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">1</span>))<span class="sc" style="color: #5E5E5E;">:</span>(n_interp<span class="sc" style="color: #5E5E5E;">*</span>i)] <span class="ot" style="color: #003B4F;">&lt;-</span></span>
<span id="cb1-56">    <span class="fu" style="color: #4758AB;">seq</span>(temperatures<span class="sc" style="color: #5E5E5E;">$</span>max_prev[i], temperatures<span class="sc" style="color: #5E5E5E;">$</span>max_2022[i], <span class="at" style="color: #657422;">length.out =</span> n_interp)</span>
<span id="cb1-57">}</span>
<span id="cb1-58"></span>
<span id="cb1-59">str_wrap_break <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(x, break_limit) {</span>
<span id="cb1-60">  <span class="co" style="color: #5E5E5E;"># Function from {usefunc} by N Rennie (https://github.com/nrennie/usefunc)</span></span>
<span id="cb1-61">  <span class="fu" style="color: #4758AB;">sapply</span>(<span class="fu" style="color: #4758AB;">strwrap</span>(x, break_limit, <span class="at" style="color: #657422;">simplify =</span> <span class="cn" style="color: #8f5902;">FALSE</span>), paste, <span class="at" style="color: #657422;">collapse =</span> <span class="st" style="color: #20794D;">"</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">"</span>)</span>
<span id="cb1-62">}</span>
<span id="cb1-63"></span>
<span id="cb1-64">title_string <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="st" style="color: #20794D;">"Huge breaks from previous records in 2022"</span></span>
<span id="cb1-65">subtitle_string <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">str_wrap_break</span>(<span class="st" style="color: #20794D;">"Stations with largest gaps between previous and new records, ordered by highest new temperature"</span>,<span class="dv" style="color: #AD0000;">60</span>)</span>
<span id="cb1-66">caption_string <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="st" style="color: #20794D;">"Only includes active weather stations with at least 50 years of observations"</span></span>
<span id="cb1-67"></span>
<span id="cb1-68"></span>
<span id="cb1-69"></span>
<span id="cb1-70"></span>
<span id="cb1-71"></span>
<span id="cb1-72">p <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">ggplot</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-73">  <span class="fu" style="color: #4758AB;">geom_line</span>(<span class="at" style="color: #657422;">data =</span> temp_interpolated, <span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> interp_value, <span class="at" style="color: #657422;">y =</span> location, <span class="at" style="color: #657422;">color =</span> interp_value), <span class="at" style="color: #657422;">lwd =</span> <span class="dv" style="color: #AD0000;">3</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-74">  <span class="co" style="color: #5E5E5E;">#</span></span>
<span id="cb1-75">  <span class="fu" style="color: #4758AB;">geom_label</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> <span class="st" style="color: #20794D;">"2022 record"</span>, <span class="at" style="color: #657422;">x =</span> <span class="fl" style="color: #AD0000;">38.7</span>, <span class="at" style="color: #657422;">y =</span> <span class="fl" style="color: #AD0000;">7.2</span>), <span class="at" style="color: #657422;">family =</span> font, <span class="at" style="color: #657422;">size =</span> <span class="fl" style="color: #AD0000;">6.5</span>, <span class="at" style="color: #657422;">label.size =</span> <span class="cn" style="color: #8f5902;">NA</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-76">  <span class="fu" style="color: #4758AB;">geom_curve</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> <span class="dv" style="color: #AD0000;">38</span>, <span class="at" style="color: #657422;">y =</span> <span class="fl" style="color: #AD0000;">7.9</span>, <span class="at" style="color: #657422;">xend =</span> <span class="fl" style="color: #AD0000;">36.9</span>, <span class="at" style="color: #657422;">yend =</span> <span class="fl" style="color: #AD0000;">8.9</span>)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-77">  <span class="co" style="color: #5E5E5E;">#</span></span>
<span id="cb1-78">  <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> <span class="st" style="color: #20794D;">"Previous </span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;"> record"</span>, <span class="at" style="color: #657422;">x =</span> <span class="dv" style="color: #AD0000;">31</span>, <span class="at" style="color: #657422;">y =</span> <span class="dv" style="color: #AD0000;">11</span>), <span class="at" style="color: #657422;">family =</span> font, <span class="at" style="color: #657422;">size =</span> <span class="fl" style="color: #AD0000;">6.5</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-79">  <span class="fu" style="color: #4758AB;">geom_curve</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">xend =</span> <span class="dv" style="color: #AD0000;">32</span>, <span class="at" style="color: #657422;">yend =</span> <span class="dv" style="color: #AD0000;">11</span>, <span class="at" style="color: #657422;">x =</span> <span class="fl" style="color: #AD0000;">32.9</span>, <span class="at" style="color: #657422;">y =</span> <span class="fl" style="color: #AD0000;">8.9</span>)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-80">  <span class="co" style="color: #5E5E5E;">#</span></span>
<span id="cb1-81">  <span class="fu" style="color: #4758AB;">geom_label</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> <span class="st" style="color: #20794D;">"Biggest leap"</span>, <span class="at" style="color: #657422;">x =</span> <span class="fl" style="color: #AD0000;">33.7</span>, <span class="at" style="color: #657422;">y =</span> <span class="dv" style="color: #AD0000;">20</span>), <span class="at" style="color: #657422;">family =</span> font, <span class="at" style="color: #657422;">size =</span> <span class="fl" style="color: #AD0000;">6.5</span>, <span class="at" style="color: #657422;">label.size =</span> <span class="cn" style="color: #8f5902;">NA</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-82">  <span class="fu" style="color: #4758AB;">geom_label</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> <span class="st" style="color: #20794D;">"6.3C"</span>, <span class="at" style="color: #657422;">x =</span> <span class="fl" style="color: #AD0000;">34.0</span>, <span class="at" style="color: #657422;">y =</span> <span class="dv" style="color: #AD0000;">19</span>), <span class="at" style="color: #657422;">family =</span> font, <span class="at" style="color: #657422;">fontface=</span><span class="st" style="color: #20794D;">"bold"</span>, <span class="at" style="color: #657422;">size =</span> <span class="fl" style="color: #AD0000;">6.5</span>, <span class="at" style="color: #657422;">label.size =</span> <span class="cn" style="color: #8f5902;">NA</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-83">  <span class="fu" style="color: #4758AB;">geom_curve</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">xend =</span> <span class="fl" style="color: #AD0000;">34.7</span>, <span class="at" style="color: #657422;">yend =</span> <span class="fl" style="color: #AD0000;">19.5</span>, <span class="at" style="color: #657422;">x =</span> <span class="fl" style="color: #AD0000;">35.7</span>, <span class="at" style="color: #657422;">y =</span> <span class="dv" style="color: #AD0000;">18</span>)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-84">  <span class="co" style="color: #5E5E5E;">#</span></span>
<span id="cb1-85">  <span class="fu" style="color: #4758AB;">geom_point</span>(<span class="at" style="color: #657422;">data =</span> temp_long, <span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> temperature, <span class="at" style="color: #657422;">y =</span> location, <span class="at" style="color: #657422;">fill =</span> temperature), <span class="at" style="color: #657422;">shape =</span> <span class="dv" style="color: #AD0000;">21</span>, <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">"black"</span>, <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">6</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-86">  <span class="co" style="color: #5E5E5E;">#</span></span>
<span id="cb1-87">  <span class="fu" style="color: #4758AB;">scale_x_continuous</span>(<span class="at" style="color: #657422;">breaks =</span> <span class="fu" style="color: #4758AB;">seq</span>(<span class="dv" style="color: #AD0000;">30</span>, <span class="dv" style="color: #AD0000;">40</span>, <span class="at" style="color: #657422;">by =</span> <span class="fl" style="color: #AD0000;">2.5</span>),<span class="at" style="color: #657422;">labels =</span> <span class="fu" style="color: #4758AB;">paste0</span>(<span class="fu" style="color: #4758AB;">seq</span>(<span class="dv" style="color: #AD0000;">30</span>, <span class="dv" style="color: #AD0000;">40</span>, <span class="at" style="color: #657422;">by =</span> <span class="fl" style="color: #AD0000;">2.5</span>),<span class="st" style="color: #20794D;">"C"</span>)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-88">  <span class="co" style="color: #5E5E5E;">#</span></span>
<span id="cb1-89">  <span class="fu" style="color: #4758AB;">labs</span>(<span class="at" style="color: #657422;">title =</span> title_string,</span>
<span id="cb1-90">       <span class="at" style="color: #657422;">subtitle =</span> subtitle_string,</span>
<span id="cb1-91">       <span class="at" style="color: #657422;">caption =</span> caption_string) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-92">  <span class="co" style="color: #5E5E5E;">#</span></span>
<span id="cb1-93">  <span class="fu" style="color: #4758AB;">theme</span>(<span class="at" style="color: #657422;">plot.title =</span> <span class="fu" style="color: #4758AB;">element_text</span>(<span class="at" style="color: #657422;">family=</span>title_font,</span>
<span id="cb1-94">                                  <span class="at" style="color: #657422;">size=</span><span class="dv" style="color: #AD0000;">28</span>,</span>
<span id="cb1-95">                                  <span class="at" style="color: #657422;">face=</span><span class="st" style="color: #20794D;">"bold"</span>,</span>
<span id="cb1-96">                                  <span class="at" style="color: #657422;">color=</span><span class="st" style="color: #20794D;">"#222222"</span>),</span>
<span id="cb1-97">        <span class="at" style="color: #657422;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;">element_text</span>(<span class="at" style="color: #657422;">family=</span>font,</span>
<span id="cb1-98">                                     <span class="at" style="color: #657422;">size=</span><span class="dv" style="color: #AD0000;">18</span>,</span>
<span id="cb1-99">                                     <span class="at" style="color: #657422;">margin=</span>ggplot2<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">margin</span>(<span class="dv" style="color: #AD0000;">9</span>,<span class="dv" style="color: #AD0000;">0</span>,<span class="dv" style="color: #AD0000;">9</span>,<span class="dv" style="color: #AD0000;">0</span>)),</span>
<span id="cb1-100">        <span class="at" style="color: #657422;">plot.caption =</span> <span class="fu" style="color: #4758AB;">element_text</span>(<span class="at" style="color: #657422;">family =</span> font, <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">14</span>,<span class="at" style="color: #657422;">hjust =</span> <span class="dv" style="color: #AD0000;">0</span>),</span>
<span id="cb1-101">        <span class="at" style="color: #657422;">plot.title.position =</span> <span class="st" style="color: #20794D;">'plot'</span>,</span>
<span id="cb1-102">        <span class="at" style="color: #657422;">plot.caption.position =</span> <span class="st" style="color: #20794D;">'plot'</span>,</span>
<span id="cb1-103">        <span class="at" style="color: #657422;">axis.title =</span> ggplot2<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">element_blank</span>(),</span>
<span id="cb1-104">        <span class="at" style="color: #657422;">axis.text =</span> ggplot2<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">element_text</span>(<span class="at" style="color: #657422;">family=</span>font,</span>
<span id="cb1-105">                                          <span class="at" style="color: #657422;">size=</span><span class="dv" style="color: #AD0000;">18</span>,</span>
<span id="cb1-106">                                          <span class="at" style="color: #657422;">color=</span><span class="st" style="color: #20794D;">"grey47"</span>),</span>
<span id="cb1-107">        <span class="at" style="color: #657422;">legend.position =</span> <span class="st" style="color: #20794D;">"none"</span>,</span>
<span id="cb1-108">        <span class="at" style="color: #657422;">title =</span> <span class="fu" style="color: #4758AB;">element_text</span>(),</span>
<span id="cb1-109">        <span class="at" style="color: #657422;">axis.line.x =</span> <span class="fu" style="color: #4758AB;">element_line</span>(<span class="at" style="color: #657422;">size =</span> <span class="fl" style="color: #AD0000;">0.7</span>, <span class="at" style="color: #657422;">linetype =</span> <span class="st" style="color: #20794D;">"solid"</span>),</span>
<span id="cb1-110">        <span class="at" style="color: #657422;">axis.ticks.y =</span> <span class="fu" style="color: #4758AB;">element_blank</span>(),</span>
<span id="cb1-111">        <span class="at" style="color: #657422;">axis.ticks.length.x =</span> <span class="fu" style="color: #4758AB;">unit</span>(<span class="dv" style="color: #AD0000;">7</span>, <span class="at" style="color: #657422;">units =</span> <span class="st" style="color: #20794D;">"points"</span> ),</span>
<span id="cb1-112">        <span class="at" style="color: #657422;">axis.text.x =</span> <span class="fu" style="color: #4758AB;">element_text</span>(<span class="at" style="color: #657422;">margin=</span><span class="fu" style="color: #4758AB;">margin</span>(<span class="at" style="color: #657422;">t =</span> <span class="dv" style="color: #AD0000;">15</span>, <span class="at" style="color: #657422;">b =</span> <span class="dv" style="color: #AD0000;">10</span>)),</span>
<span id="cb1-113">        <span class="at" style="color: #657422;">panel.grid.minor =</span> ggplot2<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">element_blank</span>(),</span>
<span id="cb1-114">        <span class="at" style="color: #657422;">panel.grid.major.y =</span> ggplot2<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">element_line</span>(<span class="at" style="color: #657422;">color=</span><span class="st" style="color: #20794D;">"#cbcbcb"</span>),</span>
<span id="cb1-115">        <span class="at" style="color: #657422;">panel.grid.major.x =</span> ggplot2<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">element_blank</span>(),</span>
<span id="cb1-116">        <span class="at" style="color: #657422;">panel.background =</span> ggplot2<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">element_blank</span>(),</span>
<span id="cb1-117">  )</span>
<span id="cb1-118"></span>
<span id="cb1-119">p</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.zakvarty.com/blog/2022-10-15-BBC-temperature-plot/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" alt="My dumbbell plot showing stations with the largest gaps between previous and new records, ordered by the highest new temperature." width="960"></p>
</div>
</div>


</section>

 ]]></description>
  <category>data visualisation</category>
  <guid>https://www.zakvarty.com/blog/2022-10-15-BBC-temperature-plot/index.html</guid>
  <pubDate>Fri, 14 Oct 2022 23:00:00 GMT</pubDate>
  <media:content url="https://www.zakvarty.com/blog/2022-10-15-BBC-temperature-plot/zdv-temperature-records.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Tidy Tuesday: Ravelry Yarn</title>
  <dc:creator>Zak Varty</dc:creator>
  <link>https://www.zakvarty.com/blog/2022-10-11-ravelry-tidy-tuesday/index.html</link>
  <description><![CDATA[ 



<p>For my first Tidy Tuesday I kept things simple with a stacked bar chart.</p>
<p>I have made several plots using <code>{ggplot2}</code> before, but this was my first attempt at making one aesthetically pleasing (forgive the pun).</p>
<p>When making this plot I learned about using custom font, colours, annotations and arrows from a lot of <a href="https://twitter.com/nrennie" title="Nicola Rennie - Twitter">@nrennie</a>’s past examples.</p>
<p>Code and figure down below ↓</p>
<div class="cell" data-fig.dpi="100">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;"># Load Packages ----</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">library</span>(dplyr)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;">library</span>(tidyr)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;">library</span>(ggplot2)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;">library</span>(forcats)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;">library</span>(showtext)</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;"># Load Fonts ----</span></span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;">font_add_google</span>(<span class="at" style="color: #657422;">name =</span> <span class="st" style="color: #20794D;">"Indie Flower"</span>, <span class="at" style="color: #657422;">family =</span> <span class="st" style="color: #20794D;">"indie-flower"</span>)</span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;">font_add_google</span>(<span class="at" style="color: #657422;">name =</span> <span class="st" style="color: #20794D;">"Permanent Marker"</span>, <span class="at" style="color: #657422;">family =</span> <span class="st" style="color: #20794D;">"marker"</span>)</span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;">showtext_auto</span>()</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;"># Load Data ----</span></span>
<span id="cb1-14">url <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="st" style="color: #20794D;">"https://github.com/rfordatascience/tidytuesday/raw/master/data/2022/2022-10-11/yarn.csv"</span></span>
<span id="cb1-15">yarn <span class="ot" style="color: #003B4F;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">read_csv</span>(<span class="at" style="color: #657422;">file =</span> url)</span>
<span id="cb1-16"></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;"># Data Handling ----</span></span>
<span id="cb1-18"></span>
<span id="cb1-19">other_weight_names <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">c</span>(</span>
<span id="cb1-20">  <span class="st" style="color: #20794D;">"Thread"</span>,</span>
<span id="cb1-21">  <span class="st" style="color: #20794D;">"Cobweb"</span>,</span>
<span id="cb1-22">  <span class="st" style="color: #20794D;">"Jumbo"</span>,</span>
<span id="cb1-23">  <span class="st" style="color: #20794D;">"DK / Sport"</span>,</span>
<span id="cb1-24">  <span class="st" style="color: #20794D;">"Aran / Worsted"</span>,</span>
<span id="cb1-25">  <span class="st" style="color: #20794D;">"No weight specified"</span>)</span>
<span id="cb1-26"></span>
<span id="cb1-27">yarn_data <span class="ot" style="color: #003B4F;">&lt;-</span> yarn <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb1-28">  <span class="fu" style="color: #4758AB;">select</span>(yarn_weight_name) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb1-29">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">yarn_weight_name =</span> <span class="fu" style="color: #4758AB;">as.character</span>(yarn_weight_name)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb1-30">  <span class="fu" style="color: #4758AB;">mutate_at</span>(<span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"yarn_weight_name"</span>), <span class="sc" style="color: #5E5E5E;">~</span><span class="fu" style="color: #4758AB;">replace_na</span>(.,<span class="st" style="color: #20794D;">"Missing"</span>)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb1-31">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">name =</span> <span class="fu" style="color: #4758AB;">fct_collapse</span>(yarn_weight_name, <span class="at" style="color: #657422;">Other =</span> other_weight_names)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb1-32">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">name =</span> <span class="fu" style="color: #4758AB;">fct_collapse</span>(name, <span class="st" style="color: #20794D;">"Double Knit"</span> <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"DK"</span>))) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb1-33">  <span class="fu" style="color: #4758AB;">group_by</span>(name) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb1-34">  <span class="fu" style="color: #4758AB;">summarise</span>(<span class="at" style="color: #657422;">value =</span> <span class="fu" style="color: #4758AB;">n</span>())</span>
<span id="cb1-35"></span>
<span id="cb1-36"><span class="co" style="color: #5E5E5E;"># Helper data frames for adding arrows to plot</span></span>
<span id="cb1-37">arrow_df_1 <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">data.frame</span>(<span class="at" style="color: #657422;">x1 =</span> <span class="dv" style="color: #AD0000;">27000</span>, <span class="at" style="color: #657422;">x2 =</span> <span class="dv" style="color: #AD0000;">27000</span>, <span class="at" style="color: #657422;">y1 =</span> <span class="fl" style="color: #AD0000;">7.5</span>, <span class="at" style="color: #657422;">y2 =</span> <span class="fl" style="color: #AD0000;">10.4</span>)</span>
<span id="cb1-38">arrow_df_2 <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">data.frame</span>(<span class="at" style="color: #657422;">x1 =</span> <span class="dv" style="color: #AD0000;">27000</span>, <span class="at" style="color: #657422;">x2 =</span> <span class="dv" style="color: #AD0000;">19000</span>, <span class="at" style="color: #657422;">y1 =</span> <span class="fl" style="color: #AD0000;">7.5</span>, <span class="at" style="color: #657422;">y2 =</span> <span class="dv" style="color: #AD0000;">10</span>)</span>
<span id="cb1-39"></span>
<span id="cb1-40"><span class="co" style="color: #5E5E5E;"># Making Plot ----</span></span>
<span id="cb1-41"></span>
<span id="cb1-42">bar_colour <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="st" style="color: #20794D;">"#483248"</span></span>
<span id="cb1-43">bg_colour <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="st" style="color: #20794D;">"#FEFBEA"</span></span>
<span id="cb1-44">title_font <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="st" style="color: #20794D;">"marker"</span></span>
<span id="cb1-45">main_font <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="st" style="color: #20794D;">"indie-flower"</span></span>
<span id="cb1-46"></span>
<span id="cb1-47">yarn_plot <span class="ot" style="color: #003B4F;">&lt;-</span> yarn_data <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb1-48">  <span class="fu" style="color: #4758AB;">ggplot</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">y =</span> <span class="fu" style="color: #4758AB;">reorder</span>(name, value), <span class="at" style="color: #657422;">x =</span> value)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-49">  <span class="fu" style="color: #4758AB;">geom_bar</span>(<span class="at" style="color: #657422;">stat =</span> <span class="st" style="color: #20794D;">"identity"</span>, <span class="at" style="color: #657422;">fill =</span> bar_colour) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-50">  <span class="fu" style="color: #4758AB;">theme_void</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-51">  <span class="fu" style="color: #4758AB;">ggtitle</span>(<span class="st" style="color: #20794D;">" </span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;"> Yarn weights on Ravelry, ordered by frequency"</span>,<span class="at" style="color: #657422;">subtitle =</span> <span class="st" style="color: #20794D;">" "</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-52">  <span class="fu" style="color: #4758AB;">theme</span>(<span class="at" style="color: #657422;">axis.title =</span> <span class="fu" style="color: #4758AB;">element_blank</span>(),</span>
<span id="cb1-53">        <span class="at" style="color: #657422;">axis.text =</span> <span class="fu" style="color: #4758AB;">element_blank</span>(),</span>
<span id="cb1-54">        <span class="at" style="color: #657422;">axis.ticks =</span> <span class="fu" style="color: #4758AB;">element_blank</span>(),</span>
<span id="cb1-55">        <span class="at" style="color: #657422;">text =</span> <span class="fu" style="color: #4758AB;">element_text</span>(<span class="at" style="color: #657422;">family =</span> main_font),</span>
<span id="cb1-56">        <span class="at" style="color: #657422;">plot.background =</span> <span class="fu" style="color: #4758AB;">element_rect</span>(<span class="at" style="color: #657422;">fill =</span> bg_colour, <span class="at" style="color: #657422;">colour =</span> bg_colour),</span>
<span id="cb1-57">        <span class="at" style="color: #657422;">panel.background =</span> <span class="fu" style="color: #4758AB;">element_rect</span>(<span class="at" style="color: #657422;">fill =</span> bg_colour, <span class="at" style="color: #657422;">colour =</span> bg_colour),</span>
<span id="cb1-58">        <span class="at" style="color: #657422;">plot.title =</span> <span class="fu" style="color: #4758AB;">element_text</span>(<span class="at" style="color: #657422;">family =</span> title_font, <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">22</span>, <span class="at" style="color: #657422;">hjust =</span> <span class="fl" style="color: #AD0000;">0.5</span>)</span>
<span id="cb1-59">  ) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-60">  <span class="fu" style="color: #4758AB;">lims</span>(<span class="at" style="color: #657422;">x =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">0</span>,<span class="dv" style="color: #AD0000;">28000</span>)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-61">  <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> name, <span class="at" style="color: #657422;">x =</span> <span class="dv" style="color: #AD0000;">200</span>),</span>
<span id="cb1-62">            <span class="at" style="color: #657422;">color =</span> bg_colour,</span>
<span id="cb1-63">            <span class="at" style="color: #657422;">hjust =</span> <span class="dv" style="color: #AD0000;">0</span>,</span>
<span id="cb1-64">            <span class="at" style="color: #657422;">family =</span> main_font,</span>
<span id="cb1-65">            <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">5</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-66">  <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> value),</span>
<span id="cb1-67">            <span class="at" style="color: #657422;">hjust =</span> <span class="dv" style="color: #AD0000;">0</span>,</span>
<span id="cb1-68">            <span class="at" style="color: #657422;">nudge_x =</span> <span class="dv" style="color: #AD0000;">200</span>,</span>
<span id="cb1-69">            <span class="at" style="color: #657422;">color =</span> bar_colour,</span>
<span id="cb1-70">            <span class="at" style="color: #657422;">family =</span> main_font,</span>
<span id="cb1-71">            <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">6</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-72">  <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> <span class="st" style="color: #20794D;">"The most popular yarn weights </span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">  are 'Fingering' and 'Double Knit'"</span>,</span>
<span id="cb1-73">                <span class="at" style="color: #657422;">x =</span> <span class="dv" style="color: #AD0000;">20000</span>,</span>
<span id="cb1-74">                <span class="at" style="color: #657422;">y =</span> <span class="fl" style="color: #AD0000;">6.7</span>),</span>
<span id="cb1-75">            <span class="at" style="color: #657422;">family =</span> main_font,</span>
<span id="cb1-76">            <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">7</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-77">  <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> <span class="st" style="color: #20794D;">"There were more missing yarn weights </span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;"> than in all remaining categories combined"</span>,</span>
<span id="cb1-78">                <span class="at" style="color: #657422;">x =</span> <span class="dv" style="color: #AD0000;">18000</span>,</span>
<span id="cb1-79">                <span class="at" style="color: #657422;">y =</span> <span class="fl" style="color: #AD0000;">1.6</span>),</span>
<span id="cb1-80">            <span class="at" style="color: #657422;">family =</span> main_font,</span>
<span id="cb1-81">            <span class="at" style="color: #657422;">size  =</span> <span class="dv" style="color: #AD0000;">7</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-82">  <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> <span class="st" style="color: #20794D;">"}"</span>),</span>
<span id="cb1-83">            <span class="at" style="color: #657422;">x =</span> <span class="dv" style="color: #AD0000;">7000</span>,</span>
<span id="cb1-84">            <span class="at" style="color: #657422;">y =</span> <span class="fl" style="color: #AD0000;">1.5</span>,</span>
<span id="cb1-85">            <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">19</span>,</span>
<span id="cb1-86">            <span class="at" style="color: #657422;">family =</span> main_font) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-87">  <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> <span class="st" style="color: #20794D;">"Tidy Tuesday 11 Oct 2022 | Data: Ravelry |  @zakvarty"</span>),</span>
<span id="cb1-88">            <span class="at" style="color: #657422;">x =</span> <span class="dv" style="color: #AD0000;">29000</span>,</span>
<span id="cb1-89">            <span class="at" style="color: #657422;">y =</span> <span class="fl" style="color: #AD0000;">4.5</span>,</span>
<span id="cb1-90">            <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">5</span>,</span>
<span id="cb1-91">            <span class="at" style="color: #657422;">family =</span> main_font,</span>
<span id="cb1-92">            <span class="at" style="color: #657422;">angle =</span> <span class="dv" style="color: #AD0000;">270</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-93">  <span class="fu" style="color: #4758AB;">geom_curve</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> x1, <span class="at" style="color: #657422;">y =</span> y1, <span class="at" style="color: #657422;">xend =</span> x2, <span class="at" style="color: #657422;">yend =</span> y2),</span>
<span id="cb1-94">             <span class="at" style="color: #657422;">data =</span> arrow_df_1,</span>
<span id="cb1-95">             <span class="at" style="color: #657422;">arrow =</span> <span class="fu" style="color: #4758AB;">arrow</span>(<span class="at" style="color: #657422;">length =</span> <span class="fu" style="color: #4758AB;">unit</span>(<span class="fl" style="color: #AD0000;">0.03</span>, <span class="st" style="color: #20794D;">"npc"</span>))) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-96">  <span class="fu" style="color: #4758AB;">geom_curve</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> x1, <span class="at" style="color: #657422;">y =</span> y1, <span class="at" style="color: #657422;">xend =</span> x2, <span class="at" style="color: #657422;">yend =</span> y2),</span>
<span id="cb1-97">             <span class="at" style="color: #657422;">data =</span> arrow_df_2,</span>
<span id="cb1-98">             <span class="at" style="color: #657422;">arrow =</span> <span class="fu" style="color: #4758AB;">arrow</span>(<span class="at" style="color: #657422;">length =</span> <span class="fu" style="color: #4758AB;">unit</span>(<span class="fl" style="color: #AD0000;">0.03</span>, <span class="st" style="color: #20794D;">"npc"</span>)))</span>
<span id="cb1-99"></span>
<span id="cb1-100">yarn_plot</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.zakvarty.com/blog/2022-10-11-ravelry-tidy-tuesday/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" alt="Stacked bar chart of yarn weights on Ravelry. Bars are descending order by their frequency, with yarn-type labels written within the bars and count values to the right of the bars. Annotations indicate that the most popular yarn weights are 'Fingering' and 'Double Knit', and that there were more missing yarn weights than in all remaining categories combined." width="768"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;"># Exported as 8x8 inch pdf and 800x700 png</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;"># (next time start by setting canvas size!)</span></span></code></pre></div>
</details>
</div>



 ]]></description>
  <category>data visualisation</category>
  <category>tidy tuesday</category>
  <guid>https://www.zakvarty.com/blog/2022-10-11-ravelry-tidy-tuesday/index.html</guid>
  <pubDate>Tue, 11 Oct 2022 23:00:00 GMT</pubDate>
  <media:content url="https://www.zakvarty.com/blog/2022-10-11-ravelry-tidy-tuesday/2022-10-11-tidy-tuesday-ravelry.png" medium="image" type="image/png" height="126" width="144"/>
</item>
<item>
  <title>Recommended Statistics Books</title>
  <dc:creator>Zak Varty</dc:creator>
  <link>https://www.zakvarty.com/blog/2022-10-10-statistics-books/index.html</link>
  <description><![CDATA[ 



<section id="statistics-and-statistical-inference-books" class="level2">
<h2 class="anchored" data-anchor-id="statistics-and-statistical-inference-books">Statistics and Statistical Inference Books</h2>
<div class="medium_right">
<p><img style="border-radius: 10%;" src="https://www.zakvarty.com/blog/2022-10-10-statistics-books/blackwells-maths-section.jpg" alt="Photograph of the mathematics section of Blackwell's book shop in Oxford."></p>
</div>
<p>While teaching a course on supervised learning last year, several students asked about what books I would recommended on statistical inference and modelling.</p>
<p>For context, the students on this course are all highly numerate and studying at the postgraduate level. What makes this request challenging is the broad range of student backgrounds, some students had a maths degree but the majority are trained and work as engineers, physicists or computer scientists.</p>
<p>This variety in backgrounds and exposure to undergraduate level statistics made recommending a single book difficult. Instead, I compiled a list of books that I have enjoyed or found useful. For each book I tried to give some guidance on whether it might match with their current statistical knowledge and what they are trying to achieve. I gave a brief description of the level and target audience of each text, which I reproduce below.</p>
<p>When evaluating whether these resources might suit your current needs, I find it helpful to skim through a section on a topic that you already know (such as linear regression). This is usually the fastest and most reliable way to assess if the book is going to be a good fit for you.</p>
<p>This list is by no means exhaustive. If you know of any gems that I have not included in this list, please do let me know!</p>
<section id="mathematical-statistics-and-data-analysis---john-a.-rice" class="level3">
<h3 class="anchored" data-anchor-id="mathematical-statistics-and-data-analysis---john-a.-rice">Mathematical Statistics and Data Analysis - John A. Rice</h3>
<p><br></p>
<div class="small_left">
<p><img style="border-radius: 2%;" src="https://www.zakvarty.com/blog/2022-10-10-statistics-books/rice.jpg" alt="Cover of Mathematical Statistics and Data Analysis by John A. Rice."></p>
</div>
<p><span class="citation" data-cites="rice2007mathematical">Rice (2007)</span> covers the basics of probability and statistics usually contained in the first couple of undergraduate statistics courses. Generally the first university courses are a bit dry, building up the required knowledge to do interesting things. This book is slightly better than the average treatment in terms of readability and is fairly comprehensive, making it well suited as a reference text. This is a book full of all the stuff you might once have known but have now forgotten, or never studied before.</p>
<p><br></p>
</section>
<section id="essential-medical-statistics---betty-kirkwood-and-jonathan-sterne" class="level3">
<h3 class="anchored" data-anchor-id="essential-medical-statistics---betty-kirkwood-and-jonathan-sterne">Essential Medical Statistics - Betty Kirkwood and Jonathan Sterne</h3>
<div class="small_left">
<p><img style="border-radius: 2%;" src="https://www.zakvarty.com/blog/2022-10-10-statistics-books/kirkwood.jpg" alt="Cover of Essential Medical Statistics by Betty Kirkwood and Jonathan Sterne."></p>
</div>
<p><br></p>
<p><span class="citation" data-cites="kirkwood2010essential">Kirkwood and Sterne (2010)</span> focuses on more advanced topics in statistics, such as inference, hypothesis testing and modelling. However, it approaches these from an applications perspective. While all of the applications it uses are from medical statistics, the authors give sufficient context that you do not need to be familiar with this area before reading. This is a very readable book, with a moderate amount of mathematical detail. I find myself revisiting it quite often.</p>
<p><br></p>
</section>
<section id="core-statistics---simon-wood" class="level3">
<h3 class="anchored" data-anchor-id="core-statistics---simon-wood">Core Statistics - Simon Wood</h3>
<div class="small_left">
<p><img style="border-radius: 2%;" src="https://www.zakvarty.com/blog/2022-10-10-statistics-books/wood.jpg" alt="Cover of Core Statistics by Simon Wood."></p>
</div>
<p><span class="citation" data-cites="wood2015core">Wood (2015)</span> gives an introduction to the core topics in statistics aimed at new graduate-level students. It is mathematically dense but written in an approachable manner and (unsurprisingly) covers all the core ideas of statistics. This means that is often a good source to get an overview of a topic and to cover the key points in that area quickly. It is probably wise to supplement this with a more applied text to see worked examples and to a more detailed text for topics that you need to explore in greater detail.</p>
<p><br></p>
</section>
<section id="in-all-likelihood---yudi-pawitan" class="level3">
<h3 class="anchored" data-anchor-id="in-all-likelihood---yudi-pawitan">In All Likelihood - Yudi Pawitan</h3>
<div class="small_left">
<p><img style="border-radius: 2%;" src="https://www.zakvarty.com/blog/2022-10-10-statistics-books/pawitan.jpg" alt="Cover of In All Likelihood by Yudi Pawitan."></p>
</div>
<p><br></p>
<p><span class="citation" data-cites="pawitan2001all">Pawitan (2001)</span> focuses entirely on likelihood inference and covers both theory and applications in a great deal of detail. I highly recommend this to supplement frequentist topics covered in core statistics and the elements of statistical learning. It builds up from very little assumed knowledge but also goes on to cover some very advanced topics in later chapters.</p>
<p><br> <br></p>
</section>
<section id="kendalls-advanced-theory-of-statistics---alan-stuart-et-al." class="level3">
<h3 class="anchored" data-anchor-id="kendalls-advanced-theory-of-statistics---alan-stuart-et-al.">Kendall’s Advanced Theory of Statistics - Alan Stuart et al.</h3>
<div class="small_left">
<p><img style="border-radius: 2%;" src="https://www.zakvarty.com/blog/2022-10-10-statistics-books/kendall-1.webp" alt="Cover of Kendall's Advanced Theory of Statistics."></p>
</div>
<p><br></p>
<p><span class="citation" data-cites="kendall1987kendall">Kendall, Stuart, and Ord (1987)</span> is an alternative to In All Likelihood, aimed at a similar audience and level. Split over several volumes this is good to do a deep-dive into a particular topic but probably not one to try and read cover to cover!</p>
<p><br> <br> <br> <br></p>
</section>
</section>
<section id="bayesian-statistics" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-statistics">Bayesian Statistics</h2>
<p>We only consider frequentist approaches to inference in this course. However, I would be remiss to not include some Bayesian texts and leave you with the impression that classical or frequentist approaches to statistics are the only option.</p>
<p>Many of the topics we cover in supervised learning can be considered from a Bayesian perspective. A Bayesian statistician does not treat our model parameters as fixed but unknown quantities, instead they consider the parameters as random variables and use probability distributions to describe their (or our) beliefs about the parameter values.</p>
<p>You might find the following books useful, either during or after the Bayesian inference course. The former is more theoretical, while the latter has a more applied focus.</p>
<p><em>Kendall’s advanced theory of statistics. Vol. 2B, Bayesian inference.</em> <span class="citation" data-cites="ohagan2004kendall">(O’Hagan and Forster 2004)</span></p>
<p><em>Bayesian Data Analysis - Gelman et al.</em> <span class="citation" data-cites="gelman2013bayesian">(Gelman et al. 2013)</span></p>



</section>

<div id="quarto-appendix"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-gelman2013bayesian" class="csl-entry">
Gelman, Andrew, John B Carlin, Hal S. Stern, David B Dunson, Aki Vehtari, and Donald B Rubin. 2013. <em>Bayesian Data Analysis</em>. 3rd ed. <span>Chapman and Hall</span>.
</div>
<div id="ref-kendall1987kendall" class="csl-entry">
Kendall, Maurice George, Alan Stuart, and J Keith Ord. 1987. <em>Kendall’s Advanced Theory of Statistics</em>. Oxford University Press.
</div>
<div id="ref-kirkwood2010essential" class="csl-entry">
Kirkwood, Betty R, and Jonathan AC Sterne. 2010. <em>Essential Medical Statistics</em>. John Wiley &amp; Sons.
</div>
<div id="ref-ohagan2004kendall" class="csl-entry">
O’Hagan, Anthony, and Jonathan J Forster. 2004. <em>Kendall’s Advanced Theory of Statistics, Volume 2b: Bayesian Inference</em>. Vol. 2b. Arnold.
</div>
<div id="ref-pawitan2001all" class="csl-entry">
Pawitan, Yudi. 2001. <em>In All Likelihood: Statistical Modelling and Inference Using Likelihood</em>. Oxford University Press.
</div>
<div id="ref-rice2007mathematical" class="csl-entry">
Rice, John A. 2007. <em>Mathematical Statistics and Data Analysis</em>. Thomson.
</div>
<div id="ref-wood2015core" class="csl-entry">
Wood, Simon N. 2015. <em>Core Statistics</em>. Cambridge University Press.
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{varty2022,
  author = {Zak Varty},
  title = {Recommended {Statistics} {Books}},
  date = {2022-10-10},
  url = {https://www.zakvarty.com/blog/2022-10-10-statistics-books},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-varty2022" class="csl-entry quarto-appendix-citeas">
Zak Varty. 2022. <span>“Recommended Statistics Books.”</span> October
10, 2022. <a href="https://www.zakvarty.com/blog/2022-10-10-statistics-books">https://www.zakvarty.com/blog/2022-10-10-statistics-books</a>.
</div></div></section></div> ]]></description>
  <category>academic skills</category>
  <category>reading</category>
  <guid>https://www.zakvarty.com/blog/2022-10-10-statistics-books/index.html</guid>
  <pubDate>Sun, 09 Oct 2022 23:00:00 GMT</pubDate>
  <media:content url="https://www.zakvarty.com/blog/2022-10-10-statistics-books/blackwells-maths-section.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Writing a rhetorical précis</title>
  <dc:creator>Zak Varty</dc:creator>
  <link>https://www.zakvarty.com/blog/2022-10-07-rhetorical-precis/index.html</link>
  <description><![CDATA[ 



<p>Photo by <a href="https://unsplash.com/@qwitka?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Maksym Kaharlytskyi</a> on <a href="https://unsplash.com/s/photos/filing-cabinet?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>
<section id="what-is-a-rhetorical-precis" class="level2">
<h2 class="anchored" data-anchor-id="what-is-a-rhetorical-precis">What is a rhetorical precis?</h2>
<div class="medium_right">
<p><img style="border-radius: 10%;" src="https://www.zakvarty.com/blog/2022-10-07-rhetorical-precis/maksym-kaharlytskyi-Q9y3LRuuxmg-unsplash.jpg" alt="Photograph of a filing cabinet filled with library index cards."></p>
</div>
<p>A rhetorical precis is a short summary and analysis of a piece of writing, which considers both the content and the delivery of the piece.</p>
<p>A rhetorical precis serves to summarise and analyse the text through:</p>
<ul>
<li>an accurate bibliographic reference to the text,</li>
<li>a list of keywords relating to the text,</li>
<li>a highly structured four-sentence paragraph providing a summary and analysis of the text.</li>
</ul>
</section>
<section id="why-write-one" class="level2">
<h2 class="anchored" data-anchor-id="why-write-one">Why write one?</h2>
<p>Keeping a rhetorical precis for each text that you read is a fantasitc way to build the skills of active reading and succinct writing. A rhetorical precis is more informative than a bib entry and more easily reviewed <em>(read: waded through)</em> than a stack of annotated papers.</p>
<p>Taken collectively, a set of rhetorical precis summaries provide a reading record that can be a tremendously useful when trying to recall the contents of a paper or book long after you originally read it.</p>
</section>
<section id="how-to-store-them" class="level2">
<h2 class="anchored" data-anchor-id="how-to-store-them">How to store them?</h2>
<p>Writing and storing these reading summaries electronically can make them even more useful. This allows you to search for topics, target audiences or keywords.</p>
<p>For this reason it can be helpful to keep them all together in one word document or plain text file. Alternatively, having a single folder with each summary as a plain text or markdown file works well if you are comfortable with searching at the command line. The same can be achieved by writing these summaries within a reference manager, if that is something you are invested in already.</p>
</section>
<section id="definition" class="level2">
<h2 class="anchored" data-anchor-id="definition">Definition</h2>
<p>Just to prove that I’m not making all this up:</p>
<blockquote class="blockquote">
<p>A rhetorical precis analyzes both the content (the what) and the delivery (the how) of a unit of spoken or written discourse. It is a highly structured four-sentence paragraph blending summary and analysis. Each of the four sentences requires specific information; students are expected to use brief quotations (to convey a sense of the author’s style and tone) and to include a terminal bibliographic reference. Practicing this sort of writing fosters precision in both reading and writing, forcing a writer to employ a variety of sentence structures and to develop a discerning eye for connotative shades of meaning. <br> <strong>Attribution:</strong> <a href="https://courses.lumenlearning.com/englishcomp2kscopex92x2/chapter/rhetorical-precis/">lumenlearning.com</a></p>
</blockquote>
</section>
<section id="format" class="level2">
<h2 class="anchored" data-anchor-id="format">Format</h2>
<p>Four sentences summarising the aim of the work, how this is addressed, why it is important and a description of the target audience.</p>
<ol type="1">
<li>Name of author, [optional phrase describing author], genre and title of work, date in parentheses (additional publishing information in parentheses); a rhetorically accurate verb (such as “asserts,” “argues,” suggests,” “implies,” claims,” etc.); a THAT clause containing the major assertion or thesis statement of the work.</li>
<li>An explanation of <em>how</em> the author develops and/or supports the thesis, usually in chronological order.</li>
<li>A statement of the author’s purpose followed by an “in order to” phrase.</li>
<li>A description of the intended audience and/or the essay’s tone</li>
</ol>
</section>
<section id="a-self-indulgent-example" class="level2">
<h2 class="anchored" data-anchor-id="a-self-indulgent-example">A (self-indulgent) example</h2>
<p>Here is a rather self-indulgent example of a rhetorical precis.</p>
<hr>
<p><code>varty2021inference</code></p>
<p><strong>Title:</strong> <em>Inference for extreme earthquake magnitudes accounting for a time-varying measurement process. {ArXiV preprint, 2021} (20 pages).</em></p>
<p><strong>Authors:</strong> <em>Zak Varty, Jonathan Tawn, Peter Atkinson and Stijn Bierman.</em></p>
<p><strong>Key words:</strong> <em>extreme value</em>, <em>earthquake</em>, <em>threshold selection</em>, <em>magnitude of completion</em>, <em>seismology</em>, <em>bootstrap.</em></p>
<p>In this paper, Varty et al (2021) propose a new threshold selection method for modelling earthquake catalogues, where the magnitude distribution is stationary but detection of small events improves over time. The paper generalises the Gutenberg-Richter law to the GPD and uses metrics based on PP and QQ plots to balance between bias and variance when selecting a time-varying threshold. This procedure more than doubles the usable catalogue size for Groningen earthquakes and gives the first emprircal evidence that the magnitude distribution in this region has a finite upper end point. The paper is targeted at applied and research statisticians with an interest in EVT but would also be accessible to a statistically-minded seismologist.</p>
<hr>
</section>
<section id="a-template-for-new-entries" class="level2">
<h2 class="anchored" data-anchor-id="a-template-for-new-entries">A template for new entries</h2>
<hr>
<p><code>firstauthorYYYYkeyword</code></p>
<p><strong>Title:</strong> <em>Title goes here. {Journal, YYYY} (NN pages).</em></p>
<p><strong>Authors:</strong> <em>Author One, Author Two and Author Three. (optional affiliations)</em></p>
<p><strong>Key words:</strong> <em>key word 1</em>, <em>key word 2</em>, <em>key work 3</em>.</p>
<ol type="1">
<li><em>What</em> is the document and <em>what</em> does it say?</li>
<li><em>How</em> do they do / show this?</li>
<li><em>Why</em> are they bothering to do this in the first place?</li>
<li><em>Who</em> is the intended audience for this work?</li>
</ol>
<p>In this DOC_TYPE, AUTHOUR VERB that THESIS_STATEMENT. They DO/SHOW this by ACTIONS. This is important to PEOPLE because REASONS. This work would be useful when PEOPLE are doing ACTIVITY.</p>
<hr>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><span class="in" style="color: #5E5E5E;">`firstauthorYYYYkeyword`</span></span>
<span id="cb1-2"></span>
<span id="cb1-3">**Title:** _Title goes here. {Journal, YYYY} (NN pages)._</span>
<span id="cb1-4"></span>
<span id="cb1-5">**Authors:** _Author One, Author Two and Author Three. (optional affiliations)_</span>
<span id="cb1-6"></span>
<span id="cb1-7">**Key words:** _key word 1_, _key word 2_, _key work 3_. </span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="ss" style="color: #20794D;">1. </span>_What_ is the document and _what_ does it say? </span>
<span id="cb1-10"><span class="ss" style="color: #20794D;">2. </span>_How_ do they do / show this?</span>
<span id="cb1-11"><span class="ss" style="color: #20794D;">3. </span>_Why_ are they bothering to do this in the first place?</span>
<span id="cb1-12"><span class="ss" style="color: #20794D;">4. </span>_Who_ is the intended audience for this work?</span>
<span id="cb1-13"></span>
<span id="cb1-14">In this DOC_TYPE, AUTHOUR VERB that THESIS<span class="sc" style="color: #5E5E5E;">\_</span>STATEMENT.</span>
<span id="cb1-15">They DO/SHOW this by ACTIONS. </span>
<span id="cb1-16">This is important to PEOPLE because REASONS. </span>
<span id="cb1-17">This work would be useful when PEOPLE are doing ACTIVITY.</span></code></pre></div>
<hr>


</section>

<div id="quarto-appendix"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{varty2022,
  author = {Zak Varty},
  title = {Writing a Rhetorical Précis},
  date = {2022-10-07},
  url = {https://www.zakvarty.com/blog/2022-10-07-rhetorical-precis},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-varty2022" class="csl-entry quarto-appendix-citeas">
Zak Varty. 2022. <span>“Writing a Rhetorical Précis.”</span> October 7,
2022. <a href="https://www.zakvarty.com/blog/2022-10-07-rhetorical-precis">https://www.zakvarty.com/blog/2022-10-07-rhetorical-precis</a>.
</div></div></section></div> ]]></description>
  <category>academic skills</category>
  <category>writing</category>
  <category>reading</category>
  <guid>https://www.zakvarty.com/blog/2022-10-07-rhetorical-precis/index.html</guid>
  <pubDate>Thu, 06 Oct 2022 23:00:00 GMT</pubDate>
  <media:content url="https://www.zakvarty.com/blog/2022-10-07-rhetorical-precis/maksym-kaharlytskyi-Q9y3LRuuxmg-unsplash.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Setting up a quarto blog</title>
  <dc:creator>Zak Varty</dc:creator>
  <link>https://www.zakvarty.com/blog/2022-09-26-adding-a-quarto-blog/index.html</link>
  <description><![CDATA[ 



<section id="what-am-i-trying-to-do" class="level1">
<h1>What am I trying to do?</h1>
<div class="medium_right">
<p><img style="border-radius: 10%;" src="https://www.zakvarty.com/blog/2022-09-26-adding-a-quarto-blog/florian-klauer-mk7D-4UCfmg-unsplash.jpg" alt="Mechanical typewriter on white background"></p>
</div>
<p>My aim here is to set up a blog within an existing quarto website. I want the blog to be a sub-domain of the main site (<code>zakvarty.com/blog</code>) and for it to inherit the styling of that site.</p>
<p>It probably would have been easier to make the blog a sub domain (<code>blog.zakvarty.com</code>) and use two separate but matching style files to make those sites look coherent. However, I wanted to make the most of the built in search features on quarto websites and am a glutton for punishment.</p>
<p>Credit to <a href="https://ddimmery.com/">Drew Dimmery</a>, whose website I used alongside the <a href="https://quarto.org/docs/guide/">quarto docs</a> to work out how to get all these pieces working together.</p>
</section>
<section id="steps" class="level1">
<h1>Steps</h1>
<ol type="1">
<li>Create a subdirectory of the website called <code>blog/</code>. This has sub-folders for each blog post and will contain the files of metadata that are common to all blog posts (e.g.&nbsp;default settings for YAML headers information and a bibliography file). <!-- --></li>
<li>Create a <a href="https://quarto.org/docs/websites/website-listings.html">listing page</a> called <code>blog.qmd</code> in the root directory. This will become the blog “landing page” and what we will point to from the website header. <!-- --></li>
<li>Add a “Blog” header item to the <code>_quarto.yml</code> file for the website and set the <code>link:</code> for this to be <code>blog.qmd</code> <!-- --></li>
<li>Added a simple example post to the <code>blog/</code> directory. See for example my <a href="https://www.github.com/zakvarty/quarto-website/blog/hello-world/">hello-world</a> post. <!-- --></li>
<li>Adjust the default YAML parameters for the blog posts by making the file <code>blog/_metadata.yml</code>. These default values can be overwritten by specifying them again in the YAML header at the top of any individual post. For examples of what you might want to include see <a href="https://www.github.com/zakvarty/quarto-website/blog/_metadata.yml">my file</a> or the <a href="https://quarto.org/docs/projects/quarto-projects.html">projects section</a> of the quarto docs. <!-- --></li>
<li>Add a simple bibliography file, called <code>library.bib</code> or similar to the <code>blog/</code> directory. Set this as the default bibliography file for each blog post by adding <code>bibliography: ../library.bib</code> to <code>blog/_metadata.yml</code>. <!-- --></li>
<li>(optional) Create a post template so that you don’t have to memorise header fields. <!-- --></li>
<li>Set your “Hello, World!” and template posts to have <code>draft: true</code> in their headers. This will prevent them from showing up on your website. <!-- --></li>
<li>Set your “Hello, World!” and template posts to have <code>freeze: true</code> in their headers. This will prevent any code in them from re-running each time the website is rendered.</li>
</ol>
<p>Freezing the code within posts will improve the build speed, as well as make the website more stable and portable. See the quarto docs on <a href="https://quarto.org/docs/websites/website-blog.html#freezing-posts">freezing posts</a> for more details. My current plan is to have this as <code>false</code> by default and change to <code>true</code> on publication of each post.</p>
</section>
<section id="checking-that-references-work" class="level1">
<h1>Checking that references work</h1>
<p>I have set up a single bibtex file in which to store references for all posts. This lives in the <code>blog/</code> directory and is set as the default <code>bibliography</code> parameter for each post in the file <code>blog/_metadata.yml</code>.</p>
<p>This is an in-line reference to <span class="citation" data-cites="wan2020network">Wan et al. (2020)</span> written as <code>@citationkey</code>. Parenthetical references, such as <span class="citation" data-cites="wan2020network">(Wan et al. 2020)</span>, are written using <code>[@citationkey]</code>. These can be strung together by separating each citation key with a semicolon, for example <span class="citation" data-cites="wan2020network wan2020network">(Wan et al. 2020, 2020)</span>.</p>
<p>To let people know the license your work is under and how they should cite your blog posts you can use the <code>appendix-style</code> argument. This can be added to the YAML header of individual blog posts or you can specify a default value in <code>blog/_metadata.yml</code>. There are three options for this parameter:</p>
<ul>
<li><code>default</code> does some nice formatting and makes the text a bit smaller than the rest of the article;</li>
<li><code>plain</code> matches the style of the rest of your post;</li>
<li><code>none</code> does not add any citation details to the end of your post.</li>
</ul>
<p>I’m currently using some pretty hacky CSS to style this website so am limited to the latter two options for now. In the process of writing this article I stumbled across some neat SCSS that I hope will fix this issue that I have made for myself! [Update: I changed to SCSS and this is now fixed!]</p>
<p><em>Note: When adding references to your posts, make sure that the <code>site-URL</code> field in your website’s <code>quarto.yml</code> does not have a trailing slash - this will be copied into the reference and break the links.</em></p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-wan2020network" class="csl-entry">
Wan, Phyllis, Tiandong Wang, Richard A Davis, and Sidney I Resnick. 2020. <span>“Are Extreme Value Estimation Methods Useful for Network Data?”</span> <em>Extremes</em> 23 (1): 171–95.
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{varty2022,
  author = {Zak Varty},
  title = {Setting up a Quarto Blog},
  date = {2022-09-26},
  url = {https://www.zakvarty.com/blog/2022-09-26-adding-a-quarto-blog},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-varty2022" class="csl-entry quarto-appendix-citeas">
Zak Varty. 2022. <span>“Setting up a Quarto Blog.”</span> September 26,
2022. <a href="https://www.zakvarty.com/blog/2022-09-26-adding-a-quarto-blog">https://www.zakvarty.com/blog/2022-09-26-adding-a-quarto-blog</a>.
</div></div></section></div> ]]></description>
  <category>quarto</category>
  <category>tutorial</category>
  <guid>https://www.zakvarty.com/blog/2022-09-26-adding-a-quarto-blog/index.html</guid>
  <pubDate>Sun, 25 Sep 2022 23:00:00 GMT</pubDate>
  <media:content url="https://www.zakvarty.com/blog/2022-09-26-adding-a-quarto-blog/florian-klauer-mk7D-4UCfmg-unsplash.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Hello, World!</title>
  <dc:creator>Zak Varty</dc:creator>
  <link>https://www.zakvarty.com/blog/2022-09-26-hello-world/index.html</link>
  <description><![CDATA[ 



<section id="some-text" class="level1">
<h1>Some Text</h1>
<p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry’s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
</section>
<section id="some-code" class="level1">
<h1>Some Code</h1>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">par</span>(<span class="at" style="color: #657422;">bg =</span> <span class="cn" style="color: #8f5902;">NA</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">plot</span>(</span>
<span id="cb1-3">    <span class="at" style="color: #657422;">x =</span> mtcars<span class="sc" style="color: #5E5E5E;">$</span>mpg,</span>
<span id="cb1-4">    <span class="at" style="color: #657422;">y =</span> mtcars<span class="sc" style="color: #5E5E5E;">$</span>cyl,</span>
<span id="cb1-5">    <span class="at" style="color: #657422;">xlab =</span> <span class="st" style="color: #20794D;">"miles per gallon"</span>,</span>
<span id="cb1-6">    <span class="at" style="color: #657422;">ylab =</span> <span class="st" style="color: #20794D;">"cyclider count"</span>,</span>
<span id="cb1-7">    <span class="at" style="color: #657422;">pch =</span> <span class="dv" style="color: #AD0000;">16</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.zakvarty.com/blog/2022-09-26-hello-world/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>Quarto</category>
  <category>Templates</category>
  <guid>https://www.zakvarty.com/blog/2022-09-26-hello-world/index.html</guid>
  <pubDate>Sun, 25 Sep 2022 23:00:00 GMT</pubDate>
  <media:content url="https://www.zakvarty.com/blog/2022-09-26-hello-world/hello-world-image.jpg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
