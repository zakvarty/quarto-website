<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zak Varty">
<meta name="dcterms.date" content="2023-11-09">
<meta name="description" content="Method of moments estimation for common data models and randomised response designs.">

<title>Zak Varty - Method of Moments Estimation for Randomised Response Surveys</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/00_favicon/favicon.ico" rel="icon">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-29RLTHLZB5"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-29RLTHLZB5', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="twitter:title" content="Zak Varty - Method of Moments Estimation for Randomised Response Surveys">
<meta name="twitter:description" content="Method of moments estimation for common data models and randomised response designs.">
<meta name="twitter:image" content="https://www.zakvarty.com/blog/2023-11-09-method-of-moments-estimation-for-randomised-response-surveys/method-of-moments-scales.png">
<meta name="twitter:image-height" content="400">
<meta name="twitter:image-width" content="400">
<meta name="twitter:image:alt" content="Method of moments for randomised responses, overlaid on an image of a set of scales.">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Zak Varty</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../talks.html"> 
<span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Writing</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../.././bookmarks.html"> <i class="bi bi-bookmark" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.twitter.com/zakvarty"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/%40zakvarty"> <i class="bi bi-youtube" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.github.com/zakvarty"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://scholar.google.com/citations?user=3H4vg4cAAAAJ&amp;hl=en&amp;oi=ao"> <i class="bi bi-google" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="dropdown-header">
 <span class="menu-text"> </span></li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-is-a-moment" id="toc-what-is-a-moment" class="nav-link active" data-scroll-target="#what-is-a-moment">What is a moment?</a></li>
  <li><a href="#what-is-the-method-of-moments" id="toc-what-is-the-method-of-moments" class="nav-link" data-scroll-target="#what-is-the-method-of-moments">What is the method of moments?</a></li>
  <li><a href="#example-1-exponential-distribution" id="toc-example-1-exponential-distribution" class="nav-link" data-scroll-target="#example-1-exponential-distribution">Example 1: Exponential distribution</a></li>
  <li><a href="#example-2---gamma-distribution." id="toc-example-2---gamma-distribution." class="nav-link" data-scroll-target="#example-2---gamma-distribution.">Example 2 - Gamma Distribution.</a></li>
  <li><a href="#example-3---beta-distribution" id="toc-example-3---beta-distribution" class="nav-link" data-scroll-target="#example-3---beta-distribution">Example 3 - Beta Distribution</a></li>
  <li><a href="#example-4---binomial-distribution-direct-response" id="toc-example-4---binomial-distribution-direct-response" class="nav-link" data-scroll-target="#example-4---binomial-distribution-direct-response">Example 4 - Binomial Distribution (Direct Response)</a></li>
  <li><a href="#example-5---binomial-distribution-random-response" id="toc-example-5---binomial-distribution-random-response" class="nav-link" data-scroll-target="#example-5---binomial-distribution-random-response">Example 5 - Binomial Distribution (Random Response)</a></li>
  <li><a href="#session-information" id="toc-session-information" class="nav-link" data-scroll-target="#session-information">Session Information</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Method of Moments Estimation for Randomised Response Surveys</h1>
  <div class="quarto-categories">
    <div class="quarto-category">privacy</div>
    <div class="quarto-category">estimation</div>
    <div class="quarto-category">statistics</div>
    <div class="quarto-category">tutorial</div>
  </div>
  </div>

<div>
  <div class="description">
    Method of moments estimation for common data models and randomised response designs.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://www.zakvarty.com/">Zak Varty</a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 9, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="what-is-a-moment" class="level2">
<h2 class="anchored" data-anchor-id="what-is-a-moment">What is a moment?</h2>
<div class="medium_right">
<figure class="figure">
<img src="method-of-moments-scales.png" alt="Method of moments for randomised responses, overlaid on an image of a set of scales." style="border-radius: 3%;" class="figure-img">
</figure>
</div>
<p>For a random variable <span class="math inline">\(X\)</span>, the <span class="math inline">\(r^{th}\)</span> moment <span class="math inline">\(\mu_r\)</span> is given by <span class="math inline">\(\mathbb{E}[X^r]\)</span>.</p>
<p>For a discrete random variable with sample space <span class="math inline">\(\mathcal{X}\)</span>, we may calculate this as:</p>
<p><span class="math display">\[ \mu_r = \mathbb{E}[X^r] = \sum_{x \in \mathcal{X}} x^r \Pr(X = x).\]</span></p>
<p>For a continuous random variable with probability density function <span class="math inline">\(f_X(x)\)</span>, we may calculate this as:</p>
<p><span class="math display">\[\mu_r = \mathbb{E}[X^r] = \int_{x \in \mathcal{X}} x^r f_X(x) \mathrm{d}x.\]</span></p>
</section>
<section id="what-is-the-method-of-moments" class="level2">
<h2 class="anchored" data-anchor-id="what-is-the-method-of-moments">What is the method of moments?</h2>
<p>Suppose we have observed values <span class="math inline">\(x_1, \ldots, x_n\)</span>, which we wish to model as realisations from a collection of <span class="math inline">\(n\)</span> independent and identically distributed (i.i.d) random variables <span class="math inline">\(X_1, \ldots, X_n\)</span>.</p>
<p>We might assume a parametric model for the probability density function <span class="math inline">\(f_X(x;\theta)\)</span>, so that the distribution of the <span class="math inline">\(X_i\)</span>’s is entirely described by one or more unknown parameter(s) <span class="math inline">\(\theta\)</span>.</p>
<p>The method of moments gives us a way to estimate the parameters <span class="math inline">\(\theta\)</span> based on the observed values <span class="math inline">\(x_1, \ldots, x_n\)</span>. We do this by equating the moments of the sample and of the assumed parametric model.</p>
</section>
<section id="example-1-exponential-distribution" class="level2">
<h2 class="anchored" data-anchor-id="example-1-exponential-distribution">Example 1: Exponential distribution</h2>
<p>Suppose that <span class="math inline">\(X_1, \ldots, X_n \ \overset{\text{i.i.d}}{\sim} \  \text{Exp}(\lambda)\)</span> with probability density function</p>
<p><span class="math display">\[f_X(x) = \lambda \exp\{-\lambda x\} \mathbb{I}[x&gt;0],\]</span></p>
<p>and that we observe a sample of values <span class="math inline">\(x_1, \ldots ,x_n\)</span> with mean <span class="math inline">\(\bar x = 3.25  = \frac{13}{4}\)</span>.</p>
<p>To estimate the single parameter <span class="math inline">\(\lambda\)</span> for this model, we can equate the first moment of the Exponential model with the first moment of our sample.</p>
<p>You might already know the expectation of an exponential variable is <span class="math inline">\(\lambda^{-1}\)</span>. If not, you might derive it for yourself:</p>
<p><span class="math display">\[\begin{align*}
    \mu_1 = \mathbb{E}[X] &amp;= \int_{-\infty}^{\infty} x f_X(x) \mathrm{d}x \\
    &amp;= \int_{-\infty}^{\infty} x \lambda \exp\{-\lambda x\} \mathbb{I}[x&gt;0] \mathrm{d}x \\
    &amp;= \int_{0}^{\infty} x \lambda \exp\{-\lambda x\} \mathrm{d}x \\
    &amp;= \left[-x \exp\{-\lambda x\}\right]_{0}^{\infty} - \int_0^{\infty} - \exp\{-\lambda x\} \mathrm{d}x \\
    &amp;= (0 - 0) + \frac{1}{\lambda} \int_0^{\infty} \lambda \exp\{-\lambda x\} \mathrm{d}x \\
    &amp;= \frac{1}{\lambda}.
\end{align*}\]</span></p>
<p>Equating this first moment of the probabiltiy model to the first sample moment, <span class="math inline">\(\frac{1}{n}\sum_{i=1}^{n} x_i = \bar x = \frac{13}{4},\)</span> we can find the method of moments estimate <span class="math inline">\(\hat \lambda\)</span> for <span class="math inline">\(\lambda\)</span>.</p>
<p>This gives us <span class="math display">\[ \frac{1}{\hat\lambda} = \bar x \quad \Rightarrow \quad \hat \lambda = \bar x ^{-1} = \frac{4}{13}.\]</span></p>
</section>
<section id="example-2---gamma-distribution." class="level2">
<h2 class="anchored" data-anchor-id="example-2---gamma-distribution.">Example 2 - Gamma Distribution.</h2>
<p>Suppose instead that we had a two parameter model for our data generating process, such as the gamma distribution. In this case, we proceed in much the same way, but to estimate the <em>two</em> parameters of this model we must equate the first <em>two</em> moments of the sample and the model, and then solve those equations simultaneously.</p>
<p>If <span class="math inline">\(Y_1, \ldots, Y_n \overset{\text{i.i.d.}}{\sim} \text{Gamma}(\alpha, \beta)\)</span>, then</p>
<p><span class="math display">\[f_X(x) = \frac{\beta ^ \alpha}{\Gamma(\alpha)} x^{\alpha - 1} \exp{-\beta x} \mathbb{I}[x &gt; 0].\]</span></p>
<p>We can calculate the first two moments of the gamma distribution directly using this probability density function. Alternatively, we might obtain these using the known closed forms for the mean and variance of a Gamma random variable:</p>
<p><span class="math display">\[\mu_1 = \mathbb{E}[Y] = \frac{\alpha}{\beta};\]</span></p>
<p><span class="math display">\[\begin{align*}
\mu_2 = \mathbb{E}[Y^2] &amp;= \text{Var}(Y) + \mathbb{E}[Y]^2 \\
&amp;= \frac{\alpha}{\beta^2} + \left(\frac{\alpha}{\beta}\right)^2 \\
&amp;= \frac{\alpha + \alpha^2}{\beta^2}.
\end{align*}\]</span></p>
<p>Equating these to the sample moments we get the system of simultaneous equations that we need to solve:</p>
<p><span class="math display">\[\begin{equation}
\bar x = \frac{\alpha}{\beta} \quad \quad \frac{1}{n}\sum_{i=1}^{n} x_i^2 = \frac{\alpha + \alpha^2}{\beta^2}.
\end{equation}\]</span></p>
<p>Suppose <span class="math inline">\(\hat \alpha\)</span> and <span class="math inline">\(\hat \beta\)</span> satisfy both of these equations. By rearrangement of the first equation we can express <span class="math inline">\(\hat \alpha = \hat \beta \bar x\)</span>. Substituting this into the second equation we find that:</p>
<p><span class="math display">\[\begin{align*}
\frac{1}{n} \sum_{i=1}^{n} x_i ^2 = \frac{\hat \beta \bar x + (\hat \beta \bar x)^2}{\hat \beta^2}
\quad
\Rightarrow
\quad
\hat\beta = \frac{\bar x}{\sum_{i=1}^{n} x_i^2 - \bar x^2}.
\end{align*}\]</span></p>
<p>This can then be substituted back into the fist equation to find that</p>
<p><span class="math display">\[\hat \alpha = \frac{\bar x^2}{\sum_{i=1}^{n} x_i^2 - \bar x^2}.\]</span></p>
<p>And so, we have found the method of moments estimators <span class="math inline">\(\hat \alpha\)</span> and <span class="math inline">\(\hat \beta\)</span> for our two model parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>.</p>
</section>
<section id="example-3---beta-distribution" class="level2">
<h2 class="anchored" data-anchor-id="example-3---beta-distribution">Example 3 - Beta Distribution</h2>
<p>Suppose instead that we had observations <span class="math inline">\(z_1, \ldots, z_n\)</span> which we model as realisations of <span class="math inline">\(Z_1, \ldots, Z_n\)</span> which are i.i.d. random variables from a beta distribution. This is another two parameter family of probability distributions, characterised by probability density functions of the form</p>
<p><span class="math display">\[ f_Z(z; \alpha, \beta) = \frac{\Gamma(\alpha + \beta)}{\Gamma(\alpha)\Gamma(\beta)} x^{\alpha - 1} (1- x)^{\beta - 1}.\]</span></p>
<p>We can show that</p>
<p><span class="math display">\[ \mathbb{E}[Z] = \frac{\alpha}{\alpha + \beta}\]</span></p>
<p>and</p>
<p><span class="math display">\[ \mathbb{E}[Z^2] = \text{Var}(Z) + \mathbb{E}[Z]^2  
        = \frac{\alpha \beta}{(\alpha + \beta)^2(\alpha + \beta + 1)}
            + \left[\frac{\alpha}{\alpha + \beta}\right]^2 \\
        = \frac{\alpha \beta + \alpha^2(\alpha + \beta + 1)}{(\alpha + \beta)^2(\alpha + \beta + 1)}.\]</span></p>
<p>So the system of equations that we wish to solve simultaneously for <span class="math inline">\(\hat \alpha\)</span> and <span class="math inline">\(\hat\beta\)</span> are</p>
<p><span class="math display">\[\sum_{i=1}^n z_i = \frac{\hat\alpha}{\hat\alpha + \hat\beta}\]</span></p>
<p>and</p>
<p><span class="math display">\[\sum_{i=1}^n z_i^2 = \frac{\hat\alpha \hat\beta + \hat\alpha^2(\hat\alpha + \hat\beta + 1)}{(\hat\alpha + \hat\beta)^2(\hat\alpha + \hat\beta + 1)}.\]</span></p>
<p>This system of equations has no closed-form solution but could be solved using numerically to optimisation to produce the method of moments estimates for a particular data set.</p>
<p>This points out that while the method of moments is conceptually simple, actually obtaining the estimates for a given data generating model is not always straightforward.</p>
</section>
<section id="example-4---binomial-distribution-direct-response" class="level2">
<h2 class="anchored" data-anchor-id="example-4---binomial-distribution-direct-response">Example 4 - Binomial Distribution (Direct Response)</h2>
<p>Suppose we are estimating some population proportion <span class="math inline">\(p\)</span> of people with a postgraduate degree. Assuming that we can take a representative sample of size <span class="math inline">\(m\)</span> from the population, we might model the number of survey respondents who have a postgraduate degree as <span class="math inline">\(N \sim \text{Bin}(m, p)\)</span>.</p>
<p>In that case <span class="math inline">\(\mathbb{E}[N] = mp\)</span> and since we only run the survey once, our sample mean is simply the one observed count.</p>
<p>Equating the fist moments of the sample and the model, we have <span class="math inline">\(n = m \hat p\)</span> and so <span class="math inline">\(\hat p = \frac{n}{m}\)</span>.</p>
<p>Therefore, under this direct-response survey design, the method of moments estimate for the population proportion of people with a postgraduate degree is simply the sample proportion.</p>
</section>
<section id="example-5---binomial-distribution-random-response" class="level2">
<h2 class="anchored" data-anchor-id="example-5---binomial-distribution-random-response">Example 5 - Binomial Distribution (Random Response)</h2>
<p>Suppose instead that we were interested in the proportion of the population who have illegally downloaded content from the internet. We will denote the true population proportion that we wish to estimate as <span class="math inline">\(p\)</span>.</p>
<p>If we use a direct response surey, some respondents might be reluctant to admit thier bad behaviour, this might cause non-response or dishonest responses from some participants. To alleviate this issue, we can use a randomised response survey to provide respondents with plausible deniability. We will add some element of randomisation to the survey design, so that for an individual respondent who replies in the affirmative we will no longer be certain that they have illegal downloads.</p>
<p>In particular, if a participant has not downloaded content from the internet, they will declare as such with probability 0.75 and with probability 0.25 they will declare that they do indeed have illegal downloads. Therefore, a respondent might reply in the affirmative to this survey <strong>either</strong> if they have truly downloaded illegal content <strong>or</strong> if they have not and happen to do so because of their random allocation. The probability of an affirmative response is given by <span class="math inline">\(\theta = p + (1-p)/4\)</span>.</p>
<p>The expectation of our total number of affirmative responses <span class="math inline">\(N\)</span> could, as in the direct response design, be modelled using a binomial distribution with <span class="math inline">\(m\)</span> trials. However, for this randomised response design the “success” probability is <span class="math inline">\(\theta\)</span> rather than <span class="math inline">\(p\)</span>.</p>
<p>Therefore the first moment of our affirmative response count <span class="math inline">\(N\)</span> is</p>
<p><span class="math display">\[\mathbb{E}[N] =  m \theta = m \left[ p + (1 - p)/4 \right],\]</span></p>
<p>which we can equate to the sample mean (i.e.&nbsp;the observed count)</p>
<p><span class="math display">\[m \left[ \hat p + (1 - \hat p)/4 \right] = n.\]</span></p>
<p>Rearranging this equality results in the following method of moments estimate for <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[\hat p = \frac{4}{3}\left(\frac{n}{m} - \frac{1}{4}\right) = \frac{4n}{3m} - \frac{1}{3}.\]</span></p>
<p>We can use this expression to get an unbiased estimate of the population proportion of people who illegally download content, based on our deliberately corrupted responses that provide individuals with plausible deniability.</p>
</section>
<section id="session-information" class="level2">
<h2 class="anchored" data-anchor-id="session-information">Session Information</h2>
<div class="cell">
<div class="cell-output-display">
<p><strong>R version 4.3.3 (2024-02-29)</strong></p>
<p><strong>Platform:</strong> x86_64-apple-darwin20 (64-bit)</p>
<p><strong>locale:</strong> en_US.UTF-8||en_US.UTF-8||en_US.UTF-8||C||en_US.UTF-8||en_US.UTF-8</p>
<p><strong>attached base packages:</strong> <em>stats</em>, <em>graphics</em>, <em>grDevices</em>, <em>utils</em>, <em>datasets</em>, <em>methods</em> and <em>base</em></p>
<p><strong>loaded via a namespace (and not attached):</strong> <em>htmlwidgets(v.1.6.4)</em>, <em>compiler(v.4.3.3)</em>, <em>fastmap(v.1.1.1)</em>, <em>cli(v.3.6.2)</em>, <em>tools(v.4.3.3)</em>, <em>htmltools(v.0.5.8.1)</em>, <em>rstudioapi(v.0.16.0)</em>, <em>yaml(v.2.3.8)</em>, <em>Rcpp(v.1.0.12)</em>, <em>pander(v.0.6.5)</em>, <em>rmarkdown(v.2.26)</em>, <em>knitr(v.1.45)</em>, <em>jsonlite(v.1.8.8)</em>, <em>xfun(v.0.43)</em>, <em>digest(v.0.6.35)</em>, <em>rlang(v.1.1.4)</em> and <em>evaluate(v.0.23)</em></p>
</div>
</div>


</section>

<div id="quarto-appendix"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.zakvarty\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2022-2024, Zak Varty.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.twitter.com/zakvarty">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/%40zakvarty">
      <i class="bi bi-youtube" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/zakvarty">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://scholar.google.com/citations?user=3H4vg4cAAAAJ&amp;hl=en&amp;oi=ao">
      <i class="bi bi-google" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>